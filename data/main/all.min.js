function setCookie(cname, cvalue, exdays) {
    const d = new Date();
    d.setTime(d.getTime() + (exdays * 24 * 60 * 60 * 1000));
    let expires = "expires=" + d.toUTCString();
    document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
}

function getCookie(cname) {
    let name = cname + "=";
    let ca = document.cookie.split(';');
    for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

var makeItRain = function () {
    $(".rain").empty();
    var counterRain = 100;
    if (window.innerWidth <= 600) counterRain = 90;
    var increment = 0;
    var drops = "";
    var backDrops = "";
    while (increment < counterRain) {
        var randoHundo = Math.floor(Math.random() * (98 - 1 + 1) + 1);
        var randoFiver = Math.floor(Math.random() * (5 - 2 + 1) + 2);
        increment += randoFiver;
        drops += '<div class="drop" style="left: ' + increment + "%; bottom: " + (randoFiver + randoFiver - 1 + 100) + "%; animation-delay: 0." + randoHundo + "s; animation-duration: 0.5" + randoHundo + 's;"><div class="stem" style="animation-delay: 0.' + randoHundo + "s; animation-duration: 0.5" + randoHundo + 's;"></div><div class="splat" style="animation-delay: 0.' + randoHundo + "s; animation-duration: 0.5" + randoHundo + 's;"></div></div>';
        backDrops += '<div class="drop" style="right: ' + increment + "%; bottom: " + (randoFiver + randoFiver - 1 + 100) + "%; animation-delay: 0." + randoHundo + "s; animation-duration: 0.5" + randoHundo + 's;"><div class="stem" style="animation-delay: 0.' + randoHundo + "s; animation-duration: 0.5" + randoHundo + 's;"></div><div class="splat" style="animation-delay: 0.' + randoHundo + "s; animation-duration: 0.5" + randoHundo + 's;"></div></div>'
    }
    $(".rain.front-row").append(drops);
    $(".rain.back-row").append(backDrops)
};
$(".splat-toggle.toggle").on("click", function () {
    $("body").toggleClass("splat-toggle");
    $(".splat-toggle.toggle").toggleClass("active");
    makeItRain()
});
$(".back-row-toggle.toggle").on("click", function () {
    $("body").toggleClass("back-row-toggle");
    $(".back-row-toggle.toggle").toggleClass("active");
    makeItRain()
});
$(".single-toggle.toggle").on("click", function () {
    $("body").toggleClass("single-toggle");
    $(".single-toggle.toggle").toggleClass("active");
    makeItRain()
});
makeItRain();

var MainMenu = function () {
    var MainMenu = function (config) {
        config = config || {};
        this.toggleBtn = $(config.toggleBtn);
        this.menu = $(config.menu);
        this.close = $(config.close);
        this.menuForm = $(config.menuForm);
        this.menuContent = $(config.menuContent);
        this.init();
        config = null
    };
    var documentClick;
    MainMenu.prototype = {
        constructor: MainMenu,
        init: function () {
            this.eventManager()
        },
        eventManager: function () {
            this.toggleBtn.on("click.openMenu", onButtonClickHandler.bind(this));
            this.close.on("click.closeMenu", onCloseClickHandler.bind(this))
        }
    };

    function onButtonClickHandler(menu, evt) {
        if (!this.menu.hasClass("open")) {
            $(".main-content").removeClass("top");
            this.menu.addClass("open");
            $(document).click(onDocumentClickHandler.bind(this));
            $(".main-mb-menu-form").addClass("seeBackground")
        }
    }

    function onCloseClickHandler(evt) {
        setTimeout(function () {
            $(".main-content").addClass("top")
        }, 500);
        $(".main-mb-menu").removeClass("open");
        $(document).off("click");
        $(".main-mb-menu-form").removeClass("seeBackground")
    }

    function onDocumentClickHandler(evt) {
        var $target = $(evt.target);
        if (!$target.closest(this.menuForm).length && !$target.closest(this.menuContent).length && this.menu.hasClass("open")) {
            onCloseClickHandler()
        }
    }
    return MainMenu
}();
$(document).ready(function () {
    var mainMenu = new MainMenu({
        menu: ".main-mb-menu",
        toggleBtn: ".main-mb-menu-btn",
        close: ".main-mb-menu-close",
        menuForm: ".main-mb-menu-form",
        menuContent: ".main-mb-menu-content"
    })
});
$(".whatClick").click(function () {
    var colorStl = ["#D35400", "#F5AB35", "#00B16A", "#9A12B3", "#F64747", "#2cbaf8"];
    var nbEle = ["orange", "yellow", "green", "purple", "red", "blue"];
    var getId = $(this).prop("id");
    var getClass = $(this).prop("class").substring(0, $(this).prop("class").indexOf(" "));
    $(".whatClick").removeAttr("style");
    $(".whatClick i").removeAttr("style");
    var inArray = nbEle.indexOf(getClass);
    $(this).attr("style", "color: " + colorStl[inArray] + ";");
    $("." + getClass + " i").attr("style", "color: " + colorStl[inArray] + ";");
    $(".main-content > div").css("display", "none");
    $("." + getId).css("display", "flex");
    if ($(this).parent().attr("desktop")) {
        $(".navigation .menu-bar li").removeClass("select");
        $(this).addClass("select")
    }
});
$(".form-control").on("click paste", function (event) {
    $("[name='my-checkbox']").each(function () {
        if (!$(this).bootstrapSwitch("state")) {
            $(this).bootstrapSwitch("toggleState")
        }
    })
});
! function (e) {
    "use strict";
    if ("function" == typeof define && define.amd) define(["jquery", "moment"], e);
    else if ("object" == typeof exports) module.exports = e(require("jquery"), require("moment"));
    else {
        if ("undefined" == typeof jQuery) throw "bootstrap-datetimepicker requires jQuery to be loaded first";
        if ("undefined" == typeof moment) throw "bootstrap-datetimepicker requires Moment.js to be loaded first";
        e(jQuery, moment)
    }
}(function (de, le) {
    "use strict";
    if (!le) throw new Error("bootstrap-datetimepicker requires Moment.js to be loaded first");
    var i = function (i, c) {
        var u, f, n, h, a, r, o, s, d, l = {},
            p = !0,
            m = !1,
            y = !1,
            b = 0,
            t = [{
                clsName: "days",
                navFnc: "M",
                navStep: 1
            }, {
                clsName: "months",
                navFnc: "y",
                navStep: 1
            }, {
                clsName: "years",
                navFnc: "y",
                navStep: 10
            }, {
                clsName: "decades",
                navFnc: "y",
                navStep: 100
            }],
            w = ["days", "months", "years", "decades"],
            g = ["top", "bottom", "auto"],
            v = ["left", "right", "auto"],
            k = ["default", "top", "bottom"],
            D = {
                up: 38,
                38: "up",
                down: 40,
                40: "down",
                left: 37,
                37: "left",
                right: 39,
                39: "right",
                tab: 9,
                9: "tab",
                escape: 27,
                27: "escape",
                enter: 13,
                13: "enter",
                pageUp: 33,
                33: "pageUp",
                pageDown: 34,
                34: "pageDown",
                shift: 16,
                16: "shift",
                control: 17,
                17: "control",
                space: 32,
                32: "space",
                t: 84,
                84: "t",
                "delete": 46,
                46: "delete"
            },
            x = {},
            C = "<td></td>",
            T = function (e) {
                return '<td colspan="3"><span class="bdpw-clock-digit center' + ("h" == e ? " cursor" : "") + '" title="Pick Hour" data-action="showHours" data-time-component="hours">10</span><span class="bdpw-timepicker-colon">:</span><span class="bdpw-clock-digit center' + ("m" == e ? " cursor" : "") + '" title="Pick Minute" data-action="showMinutes" data-time-component="minutes">30</span><span class="bdpw-timepicker-colon">:</span><span class="bdpw-clock-digit center' + ("s" == e ? " cursor" : "") + '" title="Pick Second" data-action="showSeconds" data-time-component="seconds">20</span><span class="bdpw-clock-digit center" title="Pick Second" data-action="togglePeriod" data-time-component="period">AM</span></td>'
            },
            M = '<td><a tabindex="-1" title="' + c.tooltips.incrementHour + '" data-action="' + c.tooltips.incrementHour + '"><span class="bdpw-timepicker-btn ' + c.icons.up + '"></span></a></td>',
            S = '<td><a tabindex="-1" title="' + c.tooltips.decrementHour + '" data-action="' + c.tooltips.decrementHour + '"><span class="bdpw-timepicker-btn ' + c.icons.down + '"></span></a></td>',
            P = '<td><a tabindex="-1" title="' + c.tooltips.incrementMinute + '" data-action="' + c.tooltips.incrementMinute + '"><span class="bdpw-timepicker-btn ' + c.icons.up + '"></span></a></td>',
            O = '<td><a tabindex="-1" title="' + c.tooltips.decrementMinute + '" data-action="' + c.tooltips.decrementMinute + '"><span class="bdpw-timepicker-btn ' + c.icons.down + '"></span></a></td>',
            E = '<td><a tabindex="-1" title="' + c.tooltips.incrementSecond + '" data-action="' + c.tooltips.incrementSecond + '"><span class="bdpw-timepicker-btn ' + c.icons.up + '"></span></a></td>',
            H = '<td><a tabindex="-1" title="' + c.tooltips.decrementSecond + '" data-action="' + c.tooltips.decrementSecond + '"><span class="bdpw-timepicker-btn ' + c.icons.down + '"></span></a></td>',
            I = function (e, t) {
                if (h) {
                    var n = e.hour(),
                        a = 12 == n ? 12 : n + 12;
                    return "<td>" + ('<span class="bdpw-clock-digit am-digit ' + (t || "") + (R(e, "h") ? "" : " disabled") + '" title="' + c.tooltips.pickHour + '" data-action="' + c.tooltips.pickHour + '">' + n + "</span>") + (a = '<span class="bdpw-clock-digit pm-digit ' + (t || "") + (R(e.hour(a), "h") ? "" : " disabled") + '" title="Select Hour" data-action="selectHour">' + a + "</span>") + "</td>"
                }
                return '<td><span class="bdpw-clock-digit ' + (t || "") + (R(e, "h") ? "" : " disabled") + '" title="' + c.tooltips.pickHour + '" data-action="selectHour">' + e.format("h") + "</span></td>"
            },
            Y = function (e, t) {
                return '<td><span class="bdpw-clock-digit ' + (t || "") + (R(e, "m") ? "" : " disabled") + '" title="' + c.tooltips.pickMinute + '" data-action="selectMinute">' + e.minute() + "</span></td>"
            },
            q = function (e, t) {
                return '<td><span class="bdpw-clock-digit ' + (t || "") + (R(e, "s") ? "" : " disabled") + '" title="' + c.tooltips.pickSecond + '" data-action="selectSecond">' + e.second() + "</span></td>"
            },
            B = function () {
                return void 0 !== le.tz && void 0 !== c.timeZone && null !== c.timeZone && "" !== c.timeZone
            },
            j = function (e) {
                var t;
                return t = null == e ? le() : le.isDate(e) || le.isMoment(e) ? le(e) : B() ? le.tz(e, r, c.useStrict, c.timeZone) : le(e, r, c.useStrict), B() && t.tz(c.timeZone), t
            },
            A = function (e) {
                if ("string" != typeof e || 1 < e.length) throw new TypeError("isEnabled expects a single character string parameter");
                switch (e) {
                    case "y":
                        return -1 !== a.indexOf("Y");
                    case "M":
                        return -1 !== a.indexOf("M");
                    case "d":
                        return -1 !== a.toLowerCase().indexOf("d");
                    case "h":
                    case "H":
                        return -1 !== a.toLowerCase().indexOf("h");
                    case "m":
                        return -1 !== a.indexOf("m");
                    case "s":
                        return -1 !== a.indexOf("s");
                    default:
                        return !1
                }
            },
            F = function () {
                return A("h") || A("m") || A("s")
            },
            L = function () {
                return A("y") || A("M") || A("d")
            },
            W = function () {
                var e, t, n, a, r = de("<div>").addClass("bootstrap-datetimepicker-widget dropdown-menu"),
                    i = de("<div>").addClass("datepicker").append((n = de("<thead>").append(de("<tr>").append(de("<th>").addClass("prev").attr("data-action", "previous").append(de("<span>").addClass(c.icons.previous))).append(de("<th>").addClass("picker-switch").attr("data-action", "pickerSwitch").attr("colspan", c.calendarWeeks ? "6" : "5")).append(de("<th>").addClass("next").attr("data-action", "next").append(de("<span>").addClass(c.icons.next)))), a = de("<tbody>").append(de("<tr>").append(de("<td>").attr("colspan", c.calendarWeeks ? "8" : "7"))), [de("<div>").addClass("datepicker-days").append(de("<table>").addClass("table-condensed").append(n).append(de("<tbody>"))), de("<div>").addClass("datepicker-months").append(de("<table>").addClass("table-condensed").append(n.clone()).append(a.clone())), de("<div>").addClass("datepicker-years").append(de("<table>").addClass("table-condensed").append(n.clone()).append(a.clone())), de("<div>").addClass("datepicker-decades").append(de("<table>").addClass("table-condensed").append(n.clone()).append(a.clone()))])),
                    o = de("<div>").addClass("timepicker").append((t = [], A("h") && t.push(de("<div>").addClass("timepicker-hours").append(de("<table>").append("<tbody>").addClass("table-condensed"))), A("m") && t.push(de("<div>").addClass("timepicker-minutes").append(de("<table>").append("<tbody>").addClass("table-condensed"))), A("s") && t.push(de("<div>").addClass("timepicker-seconds").append(de("<table>").append("<tbody>").addClass("table-condensed"))), t)),
                    s = de("<ul>").addClass("list-unstyled"),
                    d = de("<li>").addClass("picker-switch" + (c.collapse ? " accordion-toggle" : "")).append((e = [], c.showTodayButton && e.push(de("<td>").append(de("<a>").attr({
                        href: "#",
                        "data-action": "today",
                        title: c.tooltips.today
                    }).append(de("<span>").addClass(c.icons.today)))), !c.sideBySide && L() && F() && e.push(de("<td>").append(de("<a>").attr({
                        href: "#",
                        "data-action": "togglePicker",
                        title: c.tooltips.selectTime
                    }).append(de("<span>").addClass(c.icons.time)))), c.showClear && e.push(de("<td>").append(de("<a>").attr({
                        href: "#",
                        "data-action": "clear",
                        title: c.tooltips.clear
                    }).append(de("<span>").addClass(c.icons.clear)))), c.showClose && e.push(de("<td>").append(de("<a>").attr({
                        href: "#",
                        "data-action": "close",
                        title: c.tooltips.close
                    }).append(de("<span>").addClass(c.icons.close)))), de("<table>").addClass("table-condensed").append(de("<tbody>").append(de("<tr>").append(e)))));
                return c.inline && r.removeClass("dropdown-menu"), h && r.addClass("usetwentyfour"), A("s") && !h && r.addClass("wider"), c.sideBySide && L() && F() ? (r.addClass("timepicker-sbs"), "top" === c.toolbarPlacement && r.append(d), r.append(de("<div>").addClass("row").append(i.addClass("col-md-6")).append(o.addClass("col-md-6"))), "bottom" === c.toolbarPlacement && r.append(d), r) : ("top" === c.toolbarPlacement && s.append(d), L() && s.append(de("<li>").addClass(c.collapse && F() ? "collapse in show" : "").append(i)), "default" === c.toolbarPlacement && s.append(d), F() && s.append(de("<li>").addClass(c.collapse && L() ? "collapse" : "").append(o)), "bottom" === c.toolbarPlacement && s.append(d), s.find(".collapse").on("show.bs.collapse", function (e) {
                    de(e.target).addClass("in show")
                }).on("hidden.bs.collapse", function (e) {
                    de(e.target).removeClass("in show")
                }), r.append(s))
            },
            z = function () {
                var e, t = (m || i).position(),
                    n = (m || i).offset(),
                    a = c.widgetPositioning.vertical,
                    r = c.widgetPositioning.horizontal;
                if (c.widgetParent) e = c.widgetParent.append(y);
                else if (i.is("input")) e = i.after(y).parent();
                else {
                    if (c.inline) return void(e = i.append(y));
                    (e = i).children().first().after(y)
                }
                if ("auto" === a && (a = n.top + 1.5 * y.height() >= de(window).height() + de(window).scrollTop() && y.height() + i.outerHeight() < n.top ? "top" : "bottom"), "auto" === r && (r = e.width() < n.left + y.outerWidth() / 2 && n.left + y.outerWidth() > de(window).width() ? "right" : "left"), "top" === a ? y.addClass("top").removeClass("bottom") : y.addClass("bottom").removeClass("top"), "right" === r ? y.addClass("pull-right") : y.removeClass("pull-right"), "static" === e.css("position") && (e = e.parents().filter(function () {
                        return "static" !== de(this).css("position")
                    }).first()), 0 === e.length) throw new Error("datetimepicker component should be placed within a non-static positioned container");
                y.css({
                    top: "top" === a ? "auto" : t.top + i.outerHeight(),
                    bottom: "top" === a ? e.outerHeight() - (e === i ? 0 : t.top) : "auto",
                    left: "left" === r ? e === i ? 0 : t.left : "auto",
                    right: "left" === r ? "auto" : e.outerWidth() - i.outerWidth() - (e === i ? 0 : t.left)
                })
            },
            N = function (e) {
                "dp.change" === e.type && (e.date && e.date.isSame(e.oldDate) || !e.date && !e.oldDate) || i.trigger(e)
            },
            V = function (e) {
                "y" === e && (e = "YYYY"), N({
                    type: "dp.update",
                    change: e,
                    viewDate: f.clone()
                })
            },
            Z = function (e) {
                y && (e && (o = Math.max(b, Math.min(3, o + e))), y.find(".datepicker > div").hide().filter(".datepicker-" + t[o].clsName).show())
            },
            R = function (e, t) {
                if (!e.isValid()) return !1;
                if (c.disabledDates && "d" === t && (n = e, !0 === c.disabledDates[n.format("YYYY-MM-DD")])) return !1;
                var n, a, r, i;
                if (c.enabledDates && "d" === t && (a = e, !0 !== c.enabledDates[a.format("YYYY-MM-DD")])) return !1;
                if (c.minDate && e.isBefore(c.minDate, t)) return !1;
                if (c.maxDate && e.isAfter(c.maxDate, t)) return !1;
                if (c.daysOfWeekDisabled && "d" === t && -1 !== c.daysOfWeekDisabled.indexOf(e.day())) return !1;
                if (c.disabledHours && ("h" === t || "m" === t || "s" === t) && (r = e, !0 === c.disabledHours[r.format("H")])) return !1;
                if (c.enabledHours && ("h" === t || "m" === t || "s" === t) && (i = e, !0 !== c.enabledHours[i.format("H")])) return !1;
                if (c.disabledTimeIntervals && ("h" === t || "m" === t || "s" === t)) {
                    var o = !1;
                    if (de.each(c.disabledTimeIntervals, function () {
                            if (e.isBetween(this[0], this[1])) return !(o = !0)
                        }), o) return !1
                }
                return !0
            },
            Q = function () {
                var e, t, n, a = y.find(".datepicker-days"),
                    r = a.find("th"),
                    i = [],
                    o = [];
                if (L()) {
                    for (r.eq(0).find("span").attr("title", c.tooltips.prevMonth), r.eq(1).attr("title", c.tooltips.selectMonth), r.eq(2).find("span").attr("title", c.tooltips.nextMonth), a.find(".disabled").removeClass("disabled"), r.eq(1).text(f.format(c.dayViewHeaderFormat)), R(f.clone().subtract(1, "M"), "M") || r.eq(0).addClass("disabled"), R(f.clone().add(1, "M"), "M") || r.eq(2).addClass("disabled"), e = f.clone().startOf("M").startOf("w").startOf("d"), n = 0; n < 42; n++) 0 === e.weekday() && (t = de("<tr>"), c.calendarWeeks && t.append('<td class="cw">' + e.week() + "</td>"), i.push(t)), o = ["day"], e.isBefore(f, "M") && o.push("old"), e.isAfter(f, "M") && o.push("new"), e.isSame(u, "d") && !p && o.push("active"), R(e, "d") || o.push("disabled"), e.isSame(j(), "d") && o.push("today"), 0 !== e.day() && 6 !== e.day() || o.push("weekend"), N({
                        type: "dp.classify",
                        date: e,
                        classNames: o
                    }), t.append('<td data-action="selectDay" data-day="' + e.format("L") + '" class="' + o.join(" ") + '">' + e.date() + "</td>"), e.add(1, "d");
                    var s, d, l;
                    a.find("tbody").empty().append(i), s = y.find(".datepicker-months"), d = s.find("th"), l = s.find("tbody").find("span"), d.eq(0).find("span").attr("title", c.tooltips.prevYear), d.eq(1).attr("title", c.tooltips.selectYear), d.eq(2).find("span").attr("title", c.tooltips.nextYear), s.find(".disabled").removeClass("disabled"), R(f.clone().subtract(1, "y"), "y") || d.eq(0).addClass("disabled"), d.eq(1).text(f.year()), R(f.clone().add(1, "y"), "y") || d.eq(2).addClass("disabled"), l.removeClass("active"), u.isSame(f, "y") && !p && l.eq(u.month()).addClass("active"), l.each(function (e) {
                            R(f.clone().month(e), "M") || de(this).addClass("disabled")
                        }),
                        function () {
                            var e = y.find(".datepicker-years"),
                                t = e.find("th"),
                                n = f.clone().subtract(5, "y"),
                                a = f.clone().add(6, "y"),
                                r = "";
                            for (t.eq(0).find("span").attr("title", c.tooltips.prevDecade), t.eq(1).attr("title", c.tooltips.selectDecade), t.eq(2).find("span").attr("title", c.tooltips.nextDecade), e.find(".disabled").removeClass("disabled"), c.minDate && c.minDate.isAfter(n, "y") && t.eq(0).addClass("disabled"), t.eq(1).text(n.year() + "-" + a.year()), c.maxDate && c.maxDate.isBefore(a, "y") && t.eq(2).addClass("disabled"); !n.isAfter(a, "y");) r += '<span data-action="selectYear" class="year' + (n.isSame(u, "y") && !p ? " active" : "") + (R(n, "y") ? "" : " disabled") + '">' + n.year() + "</span>", n.add(1, "y");
                            e.find("td").html(r)
                        }(),
                        function () {
                            var e, t = y.find(".datepicker-decades"),
                                n = t.find("th"),
                                a = le({
                                    y: f.year() - f.year() % 100 - 1
                                }),
                                r = a.clone().add(100, "y"),
                                i = a.clone(),
                                o = !1,
                                s = !1,
                                d = "";
                            for (n.eq(0).find("span").attr("title", c.tooltips.prevCentury), n.eq(2).find("span").attr("title", c.tooltips.nextCentury), t.find(".disabled").removeClass("disabled"), (a.isSame(le({
                                    y: 1900
                                })) || c.minDate && c.minDate.isAfter(a, "y")) && n.eq(0).addClass("disabled"), n.eq(1).text(a.year() + "-" + r.year()), (a.isSame(le({
                                    y: 2e3
                                })) || c.maxDate && c.maxDate.isBefore(r, "y")) && n.eq(2).addClass("disabled"); !a.isAfter(r, "y");) e = a.year() + 12, o = c.minDate && c.minDate.isAfter(a, "y") && c.minDate.year() <= e, s = c.maxDate && c.maxDate.isAfter(a, "y") && c.maxDate.year() <= e, d += '<span data-action="selectDecade" class="decade' + (u.isAfter(a) && u.year() <= e ? " active" : "") + (R(a, "y") || o || s ? "" : " disabled") + '" data-selection="' + (a.year() + 6) + '">' + (a.year() + 1) + " - " + (a.year() + 12) + "</span>", a.add(12, "y");
                            d += "<span></span><span></span><span></span>", t.find("td").html(d), n.eq(1).text(i.year() + 1 + "-" + a.year())
                        }()
                }
            },
            e = function () {
                var e, t, n, a, r, i, o, s, d, l, c;
                h || (e = y.find(".timepicker [data-action=togglePeriod]"), t = u.clone().add(12 <= u.hours() ? -12 : 12, "h"), R(t, "h") ? e.removeClass("disabled") : e.addClass("disabled")), n = y.find(".timepicker-hours table>tbody"), a = f.clone(), r = "", r += "<tr>" + C + I(a.hour(11)) + I(a.hour(12), "top") + I(a.hour(1)) + C + "</tr>", r += "<tr>" + I(a.hour(10)) + C + M + C + I(a.hour(2)) + "</tr>", r += "<tr>" + I(a.hour(9), "left") + T("h") + I(a.hour(3), "right") + "</tr>", r += "<tr>" + I(a.hour(8)) + C + S + C + I(a.hour(4)) + "</tr>", r += "<tr>" + C + I(a.hour(7)) + I(a.hour(6), "bottom") + I(a.hour(5)) + C + "</tr>", n.empty().html(r), i = y.find(".timepicker-minutes table>tbody"), o = f.clone(), s = "", s += "<tr>" + C + Y(o.minute(55)) + Y(o.minute(0), "top") + Y(o.minute(5)) + C + "</tr>", s += "<tr>" + Y(o.minute(50)) + C + P + C + Y(o.minute(10)) + "</tr>", s += "<tr>" + Y(o.minute(45), "left") + T("m") + Y(o.minute(15), "right") + "</tr>", s += "<tr>" + Y(o.minute(40)) + C + O + C + Y(o.minute(20)) + "</tr>", s += "<tr>" + C + Y(o.minute(35)) + Y(o.minute(30), "bottom") + Y(o.minute(25)) + C + "</tr>", i.empty().html(s), d = y.find(".timepicker-seconds table>tbody"), l = f.clone(), c = "", c += "<tr>" + C + q(l.second(55)) + q(l.second(0), "top") + q(l.second(5)) + C + "</tr>", c += "<tr>" + q(l.second(50)) + C + E + C + q(l.second(10)) + "</tr>", c += "<tr>" + q(l.second(45), "left") + T("s") + q(l.second(15), "right") + "</tr>", c += "<tr>" + q(l.second(40)) + C + H + C + q(l.second(20)) + "</tr>", c += "<tr>" + C + q(l.second(35)) + q(l.second(30), "bottom") + q(l.second(25)) + C + "</tr>", d.empty().html(c);
                var p = y.find(".timepicker span[data-time-component]");
                p.filter("[data-time-component=hours]").text(u.format(h ? "HH" : "hh")), p.filter("[data-time-component=minutes]").text(u.format("mm")), p.filter("[data-time-component=seconds]").text(u.format("ss")), p.filter("[data-time-component=period]").text(u.format("A")), "PM" == u.format("A") ? y.find(".timepicker").addClass("pm-view") : y.find(".timepicker").removeClass("pm-view")
            },
            U = function () {
                y && (Q(), e())
            },
            G = function (e) {
                var t = p ? null : u;
                if (!e) return p = !0, n.val(""), i.data("date", ""), N({
                    type: "dp.change",
                    date: !1,
                    oldDate: t
                }), void U();
                if (e = e.clone().locale(c.locale), B() && e.tz(c.timeZone), 1 !== c.stepping)
                    for (e.minutes(Math.round(e.minutes() / c.stepping) * c.stepping).seconds(0); c.minDate && e.isBefore(c.minDate);) e.add(c.stepping, "minutes");
                R(e) ? (f = (u = e).clone(), n.val(u.format(a)), i.data("date", u.format(a)), p = !1, U(), N({
                    type: "dp.change",
                    date: u.clone(),
                    oldDate: t
                })) : (c.keepInvalid ? N({
                    type: "dp.change",
                    date: e,
                    oldDate: t
                }) : n.val(p ? "" : u.format(a)), N({
                    type: "dp.error",
                    date: e,
                    oldDate: t
                }))
            },
            J = function () {
                var t = !1;
                return y ? (y.find(".collapse").each(function () {
                    var e = de(this).data("collapse");
                    return !e || !e.transitioning || !(t = !0)
                }), t || (m && m.hasClass("btn") && m.toggleClass("active"), y.hide(), de(window).off("resize", z), y.off("click", "[data-action]"), y.off("mousedown", !1), y.remove(), y = !1, N({
                    type: "dp.hide",
                    date: u.clone()
                }), n.blur(), f = u.clone()), l) : l
            },
            K = function () {
                G(null)
            },
            X = function (e) {
                return void 0 === c.parseInputDate ? (!le.isMoment(e) || e instanceof Date) && (e = j(e)) : e = c.parseInputDate(e), e
            },
            $ = {
                next: function () {
                    var e = t[o].navFnc;
                    f.add(t[o].navStep, e), Q(), V(e)
                },
                previous: function () {
                    var e = t[o].navFnc;
                    f.subtract(t[o].navStep, e), Q(), V(e)
                },
                pickerSwitch: function () {
                    Z(1)
                },
                selectMonth: function (e) {
                    var t = de(e.target).closest("tbody").find("span").index(de(e.target));
                    f.month(t), o === b ? (G(u.clone().year(f.year()).month(f.month())), c.inline || J()) : (Z(-1), Q()), V("M")
                },
                selectYear: function (e) {
                    var t = parseInt(de(e.target).text(), 10) || 0;
                    f.year(t), o === b ? (G(u.clone().year(f.year())), c.inline || J()) : (Z(-1), Q()), V("YYYY")
                },
                selectDecade: function (e) {
                    var t = parseInt(de(e.target).data("selection"), 10) || 0;
                    f.year(t), o === b ? (G(u.clone().year(f.year())), c.inline || J()) : (Z(-1), Q()), V("YYYY")
                },
                selectDay: function (e) {
                    var t = f.clone();
                    de(e.target).is(".old") && t.subtract(1, "M"), de(e.target).is(".new") && t.add(1, "M"), G(t.date(parseInt(de(e.target).text(), 10))), F() || c.keepOpen || c.inline || J()
                },
                incrementHours: function () {
                    var e = u.clone().add(1, "h");
                    R(e, "h") && G(e)
                },
                incrementMinutes: function () {
                    var e = u.clone().add(c.stepping, "m");
                    R(e, "m") && G(e)
                },
                incrementSeconds: function () {
                    var e = u.clone().add(1, "s");
                    R(e, "s") && G(e)
                },
                decrementHours: function () {
                    var e = u.clone().subtract(1, "h");
                    R(e, "h") && G(e)
                },
                decrementMinutes: function () {
                    var e = u.clone().subtract(c.stepping, "m");
                    R(e, "m") && G(e)
                },
                decrementSeconds: function () {
                    var e = u.clone().subtract(1, "s");
                    R(e, "s") && G(e)
                },
                togglePeriod: function () {
                    G(u.clone().add(12 <= u.hours() ? -12 : 12, "h"))
                },
                togglePicker: function (e) {
                    var t, n = de(e.target),
                        a = n.closest("ul"),
                        r = a.find(".collapse.in"),
                        i = a.find(".collapse:not(.in)");
                    if (r && r.length) {
                        if ((t = r.data("collapse")) && t.transitioning) return;
                        r.collapse ? (r.collapse("hide"), i.collapse("show")) : (r.removeClass("in show"), i.addClass("in show")), n.is("span") ? n.toggleClass(c.icons.time + " " + c.icons.date) : n.find("span").toggleClass(c.icons.time + " " + c.icons.date)
                    }
                },
                showPicker: function () {
                    y.find(".timepicker > div:not(.timepicker-picker)").hide(), y.find(".timepicker .timepicker-picker").show()
                },
                showHours: function () {
                    y.find(".timepicker > div:not(.timepicker-hours)").hide(), y.find(".timepicker .timepicker-hours").show()
                },
                showMinutes: function () {
                    y.find(".timepicker > div:not(.timepicker-minutes)").hide(), y.find(".timepicker .timepicker-minutes").show()
                },
                showSeconds: function () {
                    y.find(".timepicker > div:not(.timepicker-seconds)").hide(), y.find(".timepicker .timepicker-seconds").show()
                },
                selectHour: function (e) {
                    var t = parseInt(de(e.target).text(), 10);
                    h || (12 <= u.hours() ? 12 !== t && (t += 12) : 12 === t && (t = 0)), G(u.clone().hours(t)), $.showMinutes.call(l)
                },
                selectMinute: function (e) {
                    G(u.clone().minutes(parseInt(de(e.target).text(), 10))), A("s") && $.showSeconds.call(l)
                },
                selectSecond: function (e) {
                    G(u.clone().seconds(parseInt(de(e.target).text(), 10)))
                },
                clear: K,
                today: function () {
                    var e = j();
                    R(e, "d") && G(e)
                },
                close: J
            },
            _ = function (e) {
                return de(e.currentTarget).is(".disabled") || $[de(e.currentTarget).data("action")].apply(l, arguments)
            },
            ee = function () {
                var e;
                return n.prop("disabled") || !c.ignoreReadonly && n.prop("readonly") || y || (void 0 !== n.val() && 0 !== n.val().trim().length ? G(X(n.val().trim())) : p && c.useCurrent && (c.inline || n.is("input") && 0 === n.val().trim().length) && (e = j(), "string" == typeof c.useCurrent && (e = {
                    year: function (e) {
                        return e.month(0).date(1).hours(0).seconds(0).minutes(0)
                    },
                    month: function (e) {
                        return e.date(1).hours(0).seconds(0).minutes(0)
                    },
                    day: function (e) {
                        return e.hours(0).seconds(0).minutes(0)
                    },
                    hour: function (e) {
                        return e.seconds(0).minutes(0)
                    },
                    minute: function (e) {
                        return e.seconds(0)
                    }
                } [c.useCurrent](e)), G(e)), y = W(), function () {
                    var e = de("<tr>"),
                        t = f.clone().startOf("w").startOf("d");
                    for (!0 === c.calendarWeeks && e.append(de("<th>").addClass("cw").text("#")); t.isBefore(f.clone().endOf("w"));) e.append(de("<th>").addClass("dow").text(t.format("dd"))), t.add(1, "d");
                    y.find(".datepicker-days thead").append(e)
                }(), function () {
                    for (var e = [], t = f.clone().startOf("y").startOf("d"); t.isSame(f, "y");) e.push(de("<span>").attr("data-action", "selectMonth").addClass("month").text(t.format("MMM"))), t.add(1, "M");
                    y.find(".datepicker-months td").empty().append(e)
                }(), y.find(".timepicker-minutes").hide(), y.find(".timepicker-seconds").hide(), U(), Z(), de(window).on("resize", z), y.on("click", "[data-action]", _), y.on("mousedown", !1), m && m.hasClass("btn") && m.toggleClass("active"), z(), y.show(), c.focusOnShow && !n.is(":focus") && n.focus(), N({
                    type: "dp.show"
                })), l
            },
            te = function () {
                return y ? J() : ee()
            },
            ne = function (e) {
                var t, n, a, r, i = null,
                    o = [],
                    s = {},
                    d = e.which;
                for (t in x[d] = "p", x) x.hasOwnProperty(t) && "p" === x[t] && (o.push(t), parseInt(t, 10) !== d && (s[t] = !0));
                for (t in c.keyBinds)
                    if (c.keyBinds.hasOwnProperty(t) && "function" == typeof c.keyBinds[t] && (a = t.split(" ")).length === o.length && D[d] === a[a.length - 1]) {
                        for (r = !0, n = a.length - 2; 0 <= n; n--)
                            if (!(D[a[n]] in s)) {
                                r = !1;
                                break
                            } if (r) {
                            i = c.keyBinds[t];
                            break
                        }
                    } i && (i.call(l, y), e.stopPropagation(), e.preventDefault())
            },
            ae = function (e) {
                x[e.which] = "r", e.stopPropagation(), e.preventDefault()
            },
            re = function (e) {
                var t = de(e.target).val().trim(),
                    n = t ? X(t) : null;
                return G(n), e.stopImmediatePropagation(), !1
            },
            ie = function (e) {
                var t = {};
                return de.each(e, function () {
                    var e = X(this);
                    e.isValid() && (t[e.format("YYYY-MM-DD")] = !0)
                }), !!Object.keys(t).length && t
            },
            oe = function (e) {
                var t = {};
                return de.each(e, function () {
                    t[this] = !0
                }), !!Object.keys(t).length && t
            },
            se = function () {
                var e = c.format || "L LT";
                a = e.replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, function (e) {
                    return (u.localeData().longDateFormat(e) || e).replace(/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g, function (e) {
                        return u.localeData().longDateFormat(e) || e
                    })
                }), (r = c.extraFormats ? c.extraFormats.slice() : []).indexOf(e) < 0 && r.indexOf(a) < 0 && r.push(a), h = a.toLowerCase().indexOf("a") < 1 && a.replace(/\[.*?\]/g, "").indexOf("h") < 1, A("y") && (b = 2), A("M") && (b = 1), A("d") && (b = 0), o = Math.max(b, o), p || G(u)
            };
        if (l.destroy = function () {
                J(), n.off({
                    change: re,
                    blur: blur,
                    keydown: ne,
                    keyup: ae,
                    focus: c.allowInputToggle ? J : ""
                }), i.is("input") ? n.off({
                    focus: ee
                }) : m && (m.off("click", te), m.off("mousedown", !1)), i.removeData("DateTimePicker"), i.removeData("date")
            }, l.toggle = te, l.show = ee, l.hide = J, l.disable = function () {
                return J(), m && m.hasClass("btn") && m.addClass("disabled"), n.prop("disabled", !0), l
            }, l.enable = function () {
                return m && m.hasClass("btn") && m.removeClass("disabled"), n.prop("disabled", !1), l
            }, l.ignoreReadonly = function (e) {
                if (0 === arguments.length) return c.ignoreReadonly;
                if ("boolean" != typeof e) throw new TypeError("ignoreReadonly () expects a boolean parameter");
                return c.ignoreReadonly = e, l
            }, l.options = function (e) {
                if (0 === arguments.length) return de.extend(!0, {}, c);
                if (!(e instanceof Object)) throw new TypeError("options() options parameter should be an object");
                return de.extend(!0, c, e), de.each(c, function (e, t) {
                    if (void 0 === l[e]) throw new TypeError("option " + e + " is not recognized!");
                    l[e](t)
                }), l
            }, l.date = function (e) {
                if (0 === arguments.length) return p ? null : u.clone();
                if (!(null === e || "string" == typeof e || le.isMoment(e) || e instanceof Date)) throw new TypeError("date() parameter must be one of [null, string, moment or Date]");
                return G(null === e ? null : X(e)), l
            }, l.format = function (e) {
                if (0 === arguments.length) return c.format;
                if ("string" != typeof e && ("boolean" != typeof e || !1 !== e)) throw new TypeError("format() expects a string or boolean:false parameter " + e);
                return c.format = e, a && se(), l
            }, l.timeZone = function (e) {
                if (0 === arguments.length) return c.timeZone;
                if ("string" != typeof e) throw new TypeError("newZone() expects a string parameter");
                return c.timeZone = e, l
            }, l.dayViewHeaderFormat = function (e) {
                if (0 === arguments.length) return c.dayViewHeaderFormat;
                if ("string" != typeof e) throw new TypeError("dayViewHeaderFormat() expects a string parameter");
                return c.dayViewHeaderFormat = e, l
            }, l.extraFormats = function (e) {
                if (0 === arguments.length) return c.extraFormats;
                if (!1 !== e && !(e instanceof Array)) throw new TypeError("extraFormats() expects an array or false parameter");
                return c.extraFormats = e, r && se(), l
            }, l.disabledDates = function (e) {
                if (0 === arguments.length) return c.disabledDates ? de.extend({}, c.disabledDates) : c.disabledDates;
                if (!e) return c.disabledDates = !1, U(), l;
                if (!(e instanceof Array)) throw new TypeError("disabledDates() expects an array parameter");
                return c.disabledDates = ie(e), c.enabledDates = !1, U(), l
            }, l.enabledDates = function (e) {
                if (0 === arguments.length) return c.enabledDates ? de.extend({}, c.enabledDates) : c.enabledDates;
                if (!e) return c.enabledDates = !1, U(), l;
                if (!(e instanceof Array)) throw new TypeError("enabledDates() expects an array parameter");
                return c.enabledDates = ie(e), c.disabledDates = !1, U(), l
            }, l.daysOfWeekDisabled = function (e) {
                if (0 === arguments.length) return c.daysOfWeekDisabled.splice(0);
                if ("boolean" == typeof e && !e) return c.daysOfWeekDisabled = !1, U(), l;
                if (!(e instanceof Array)) throw new TypeError("daysOfWeekDisabled() expects an array parameter");
                if (c.daysOfWeekDisabled = e.reduce(function (e, t) {
                        return 6 < (t = parseInt(t, 10)) || t < 0 || isNaN(t) || -1 === e.indexOf(t) && e.push(t), e
                    }, []).sort(), c.useCurrent && !c.keepInvalid) {
                    for (var t = 0; !R(u, "d");) {
                        if (u.add(1, "d"), 31 === t) throw "Tried 31 times to find a valid date";
                        t++
                    }
                    G(u)
                }
                return U(), l
            }, l.maxDate = function (e) {
                if (0 === arguments.length) return c.maxDate ? c.maxDate.clone() : c.maxDate;
                if ("boolean" == typeof e && !1 === e) return c.maxDate = !1, U(), l;
                "string" == typeof e && ("now" !== e && "moment" !== e || (e = j()));
                var t = X(e);
                if (!t.isValid()) throw new TypeError("maxDate() Could not parse date parameter: " + e);
                if (c.minDate && t.isBefore(c.minDate)) throw new TypeError("maxDate() date parameter is before options.minDate: " + t.format(a));
                return c.maxDate = t, c.useCurrent && !c.keepInvalid && u.isAfter(e) && G(c.maxDate), f.isAfter(t) && (f = t.clone().subtract(c.stepping, "m")), U(), l
            }, l.minDate = function (e) {
                if (0 === arguments.length) return c.minDate ? c.minDate.clone() : c.minDate;
                if ("boolean" == typeof e && !1 === e) return c.minDate = !1, U(), l;
                "string" == typeof e && ("now" !== e && "moment" !== e || (e = j()));
                var t = X(e);
                if (!t.isValid()) throw new TypeError("minDate() Could not parse date parameter: " + e);
                if (c.maxDate && t.isAfter(c.maxDate)) throw new TypeError("minDate() date parameter is after options.maxDate: " + t.format(a));
                return c.minDate = t, c.useCurrent && !c.keepInvalid && u.isBefore(e) && G(c.minDate), f.isBefore(t) && (f = t.clone().add(c.stepping, "m")), U(), l
            }, l.defaultDate = function (e) {
                if (0 === arguments.length) return c.defaultDate ? c.defaultDate.clone() : c.defaultDate;
                if (!e) return c.defaultDate = !1, l;
                "string" == typeof e && (e = "now" === e || "moment" === e ? j() : j(e));
                var t = X(e);
                if (!t.isValid()) throw new TypeError("defaultDate() Could not parse date parameter: " + e);
                if (!R(t)) throw new TypeError("defaultDate() date passed is invalid according to component setup validations");
                return c.defaultDate = t, (c.defaultDate && c.inline || "" === n.val().trim()) && G(c.defaultDate), l
            }, l.locale = function (e) {
                if (0 === arguments.length) return c.locale;
                if (!le.localeData(e)) throw new TypeError("locale() locale " + e + " is not loaded from moment locales!");
                return c.locale = e, u.locale(c.locale), f.locale(c.locale), a && se(), y && (J(), ee()), l
            }, l.stepping = function (e) {
                return 0 === arguments.length ? c.stepping : (e = parseInt(e, 10), (isNaN(e) || e < 1) && (e = 1), c.stepping = e, l)
            }, l.useCurrent = function (e) {
                var t = ["year", "month", "day", "hour", "minute"];
                if (0 === arguments.length) return c.useCurrent;
                if ("boolean" != typeof e && "string" != typeof e) throw new TypeError("useCurrent() expects a boolean or string parameter");
                if ("string" == typeof e && -1 === t.indexOf(e.toLowerCase())) throw new TypeError("useCurrent() expects a string parameter of " + t.join(", "));
                return c.useCurrent = e, l
            }, l.collapse = function (e) {
                if (0 === arguments.length) return c.collapse;
                if ("boolean" != typeof e) throw new TypeError("collapse() expects a boolean parameter");
                return c.collapse === e || (c.collapse = e, y && (J(), ee())), l
            }, l.icons = function (e) {
                if (0 === arguments.length) return de.extend({}, c.icons);
                if (!(e instanceof Object)) throw new TypeError("icons() expects parameter to be an Object");
                return de.extend(c.icons, e), y && (J(), ee()), l
            }, l.tooltips = function (e) {
                if (0 === arguments.length) return de.extend({}, c.tooltips);
                if (!(e instanceof Object)) throw new TypeError("tooltips() expects parameter to be an Object");
                return de.extend(c.tooltips, e), y && (J(), ee()), l
            }, l.useStrict = function (e) {
                if (0 === arguments.length) return c.useStrict;
                if ("boolean" != typeof e) throw new TypeError("useStrict() expects a boolean parameter");
                return c.useStrict = e, l
            }, l.sideBySide = function (e) {
                if (0 === arguments.length) return c.sideBySide;
                if ("boolean" != typeof e) throw new TypeError("sideBySide() expects a boolean parameter");
                return c.sideBySide = e, y && (J(), ee()), l
            }, l.viewMode = function (e) {
                if (0 === arguments.length) return c.viewMode;
                if ("string" != typeof e) throw new TypeError("viewMode() expects a string parameter");
                if (-1 === w.indexOf(e)) throw new TypeError("viewMode() parameter must be one of (" + w.join(", ") + ") value");
                return c.viewMode = e, o = Math.max(w.indexOf(e), b), Z(), l
            }, l.toolbarPlacement = function (e) {
                if (0 === arguments.length) return c.toolbarPlacement;
                if ("string" != typeof e) throw new TypeError("toolbarPlacement() expects a string parameter");
                if (-1 === k.indexOf(e)) throw new TypeError("toolbarPlacement() parameter must be one of (" + k.join(", ") + ") value");
                return c.toolbarPlacement = e, y && (J(), ee()), l
            }, l.widgetPositioning = function (e) {
                if (0 === arguments.length) return de.extend({}, c.widgetPositioning);
                if ("[object Object]" !== {}.toString.call(e)) throw new TypeError("widgetPositioning() expects an object variable");
                if (e.horizontal) {
                    if ("string" != typeof e.horizontal) throw new TypeError("widgetPositioning() horizontal variable must be a string");
                    if (e.horizontal = e.horizontal.toLowerCase(), -1 === v.indexOf(e.horizontal)) throw new TypeError("widgetPositioning() expects horizontal parameter to be one of (" + v.join(", ") + ")");
                    c.widgetPositioning.horizontal = e.horizontal
                }
                if (e.vertical) {
                    if ("string" != typeof e.vertical) throw new TypeError("widgetPositioning() vertical variable must be a string");
                    if (e.vertical = e.vertical.toLowerCase(), -1 === g.indexOf(e.vertical)) throw new TypeError("widgetPositioning() expects vertical parameter to be one of (" + g.join(", ") + ")");
                    c.widgetPositioning.vertical = e.vertical
                }
                return U(), l
            }, l.calendarWeeks = function (e) {
                if (0 === arguments.length) return c.calendarWeeks;
                if ("boolean" != typeof e) throw new TypeError("calendarWeeks() expects parameter to be a boolean value");
                return c.calendarWeeks = e, U(), l
            }, l.showTodayButton = function (e) {
                if (0 === arguments.length) return c.showTodayButton;
                if ("boolean" != typeof e) throw new TypeError("showTodayButton() expects a boolean parameter");
                return c.showTodayButton = e, y && (J(), ee()), l
            }, l.showClear = function (e) {
                if (0 === arguments.length) return c.showClear;
                if ("boolean" != typeof e) throw new TypeError("showClear() expects a boolean parameter");
                return c.showClear = e, y && (J(), ee()), l
            }, l.widgetParent = function (e) {
                if (0 === arguments.length) return c.widgetParent;
                if ("string" == typeof e && (e = de(e)), null !== e && "string" != typeof e && !(e instanceof de)) throw new TypeError("widgetParent() expects a string or a jQuery object parameter");
                return c.widgetParent = e, y && (J(), ee()), l
            }, l.keepOpen = function (e) {
                if (0 === arguments.length) return c.keepOpen;
                if ("boolean" != typeof e) throw new TypeError("keepOpen() expects a boolean parameter");
                return c.keepOpen = e, l
            }, l.focusOnShow = function (e) {
                if (0 === arguments.length) return c.focusOnShow;
                if ("boolean" != typeof e) throw new TypeError("focusOnShow() expects a boolean parameter");
                return c.focusOnShow = e, l
            }, l.inline = function (e) {
                if (0 === arguments.length) return c.inline;
                if ("boolean" != typeof e) throw new TypeError("inline() expects a boolean parameter");
                return c.inline = e, l
            }, l.clear = function () {
                return K(), l
            }, l.keyBinds = function (e) {
                return 0 === arguments.length ? c.keyBinds : (c.keyBinds = e, l)
            }, l.getMoment = function (e) {
                return j(e)
            }, l.debug = function (e) {
                if ("boolean" != typeof e) throw new TypeError("debug() expects a boolean parameter");
                return c.debug = e, l
            }, l.allowInputToggle = function (e) {
                if (0 === arguments.length) return c.allowInputToggle;
                if ("boolean" != typeof e) throw new TypeError("allowInputToggle() expects a boolean parameter");
                return c.allowInputToggle = e, l
            }, l.showClose = function (e) {
                if (0 === arguments.length) return c.showClose;
                if ("boolean" != typeof e) throw new TypeError("showClose() expects a boolean parameter");
                return c.showClose = e, l
            }, l.keepInvalid = function (e) {
                if (0 === arguments.length) return c.keepInvalid;
                if ("boolean" != typeof e) throw new TypeError("keepInvalid() expects a boolean parameter");
                return c.keepInvalid = e, l
            }, l.datepickerInput = function (e) {
                if (0 === arguments.length) return c.datepickerInput;
                if ("string" != typeof e) throw new TypeError("datepickerInput() expects a string parameter");
                return c.datepickerInput = e, l
            }, l.parseInputDate = function (e) {
                if (0 === arguments.length) return c.parseInputDate;
                if ("function" != typeof e) throw new TypeError("parseInputDate() sholud be as function");
                return c.parseInputDate = e, l
            }, l.disabledTimeIntervals = function (e) {
                if (0 === arguments.length) return c.disabledTimeIntervals ? de.extend({}, c.disabledTimeIntervals) : c.disabledTimeIntervals;
                if (!e) return c.disabledTimeIntervals = !1, U(), l;
                if (!(e instanceof Array)) throw new TypeError("disabledTimeIntervals() expects an array parameter");
                return c.disabledTimeIntervals = e, U(), l
            }, l.disabledHours = function (e) {
                if (0 === arguments.length) return c.disabledHours ? de.extend({}, c.disabledHours) : c.disabledHours;
                if (!e) return c.disabledHours = !1, U(), l;
                if (!(e instanceof Array)) throw new TypeError("disabledHours() expects an array parameter");
                if (c.disabledHours = oe(e), c.enabledHours = !1, c.useCurrent && !c.keepInvalid) {
                    for (var t = 0; !R(u, "h");) {
                        if (u.add(1, "h"), 24 === t) throw "Tried 24 times to find a valid date";
                        t++
                    }
                    G(u)
                }
                return U(), l
            }, l.enabledHours = function (e) {
                if (0 === arguments.length) return c.enabledHours ? de.extend({}, c.enabledHours) : c.enabledHours;
                if (!e) return c.enabledHours = !1, U(), l;
                if (!(e instanceof Array)) throw new TypeError("enabledHours() expects an array parameter");
                if (c.enabledHours = oe(e), c.disabledHours = !1, c.useCurrent && !c.keepInvalid) {
                    for (var t = 0; !R(u, "h");) {
                        if (u.add(1, "h"), 24 === t) throw "Tried 24 times to find a valid date";
                        t++
                    }
                    G(u)
                }
                return U(), l
            }, l.viewDate = function (e) {
                if (0 === arguments.length) return f.clone();
                if (!e) return f = u.clone(), l;
                if (!("string" == typeof e || le.isMoment(e) || e instanceof Date)) throw new TypeError("viewDate() parameter must be one of [string, moment or Date]");
                return f = X(e), V(), l
            }, i.is("input")) n = i;
        else if (0 === (n = i.find(c.datepickerInput)).length) n = i.find("input");
        else if (!n.is("input")) throw new Error('CSS class "' + c.datepickerInput + '" cannot be applied to non input element');
        if (i.hasClass("input-group") && (m = 0 === i.find(".datepickerbutton").length ? i.find(".input-group-addon") : i.find(".datepickerbutton")), !c.inline && !n.is("input")) throw new Error("Could not initialize DateTimePicker without an input element");
        return u = j(), f = u.clone(), de.extend(!0, c, (d = {}, (s = i.is("input") || c.inline ? i.data() : i.find("input").data()).dateOptions && s.dateOptions instanceof Object && (d = de.extend(!0, d, s.dateOptions)), de.each(c, function (e) {
            var t = "date" + e.charAt(0).toUpperCase() + e.slice(1);
            void 0 !== s[t] && (d[e] = s[t])
        }), d)), l.options(c), se(), n.on({
            change: re,
            blur: c.debug ? "" : J,
            keydown: ne,
            keyup: ae,
            focus: c.allowInputToggle ? ee : ""
        }), i.is("input") ? n.on({
            focus: ee
        }) : m && (m.on("click", te), m.on("mousedown", !1)), n.prop("disabled") && l.disable(), n.is("input") && 0 !== n.val().trim().length ? G(X(n.val().trim())) : c.defaultDate && void 0 === n.attr("placeholder") && G(c.defaultDate), c.inline && ee(), l
    };
    return de.fn.datetimepicker = function (n) {
        n = n || {};
        var t, a = Array.prototype.slice.call(arguments, 1),
            r = !0;
        if ("object" == typeof n) return this.each(function () {
            var e, t = de(this);
            t.data("DateTimePicker") || (e = de.extend(!0, {}, de.fn.datetimepicker.defaults, n), t.data("DateTimePicker", i(t, e)))
        });
        if ("string" == typeof n) return this.each(function () {
            var e = de(this).data("DateTimePicker");
            if (!e) throw new Error('bootstrap-datetimepicker("' + n + '") method was called on an element that is not using DateTimePicker');
            t = e[n].apply(e, a), r = t === e
        }), r || -1 < de.inArray(n, ["destroy", "hide", "show", "toggle"]) ? this : t;
        throw new TypeError("Invalid arguments for DateTimePicker: " + n)
    }, de.fn.datetimepicker.defaults = {
        timeZone: "",
        format: !1,
        dayViewHeaderFormat: "MMMM YYYY",
        extraFormats: !1,
        stepping: 1,
        minDate: !1,
        maxDate: !1,
        useCurrent: !0,
        collapse: !0,
        locale: le.locale(),
        defaultDate: !1,
        disabledDates: !1,
        enabledDates: !1,
        icons: {
            time: "glyphicon glyphicon-time far fa-clock",
            date: "glyphicon glyphicon-calendar fa fa-calendar",
            up: "glyphicon glyphicon-chevron-up fa fa-chevron-up",
            down: "glyphicon glyphicon-chevron-down fa fa-chevron-down",
            previous: "glyphicon glyphicon-chevron-left fa fa-chevron-left",
            next: "glyphicon glyphicon-chevron-right fa fa-chevron-right",
            today: "glyphicon glyphicon-screenshot far fa-calendar-check",
            clear: "glyphicon glyphicon-trash fa fa-trash",
            close: "glyphicon glyphicon-remove fa fa-times"
        },
        tooltips: {
            today: "Pobierz obecny czas",
            clear: "Wyczy wybr ",
            close: "Zamknij selektor",
            selectMonth: "Wybierz miesic",
            prevMonth: "Poprzedni miesic",
            nextMonth: "Nastpny miesic",
            selectYear: "Wybierz rok",
            prevYear: "Poprzedni rok",
            nextYear: "Nastpny rok",
            selectDecade: "Wybierz dekade",
            prevDecade: "Poprzedna dekada",
            nextDecade: "Nastpna dekada",
            prevCentury: "Poprzedni wiek",
            nextCentury: "Nastpny wiek",
            pickHour: "Wybierz godzin",
            incrementHour: "Zwiksz godzin",
            decrementHour: "Zmniejsz godzin",
            pickMinute: "Wybierz minute",
            incrementMinute: "Zwiksz minuty",
            decrementMinute: "Zmniejsz minuty",
            pickSecond: "Wybierz sekund",
            incrementSecond: "Zwiksz sekundy",
            decrementSecond: "Zmniejsz sekundy",
            togglePeriod: "Przecz okres dnia",
            selectTime: "Wybierz czas"
        },
        useStrict: !1,
        sideBySide: !1,
        daysOfWeekDisabled: !1,
        calendarWeeks: !1,
        viewMode: "days",
        toolbarPlacement: "default",
        showTodayButton: !1,
        showClear: !1,
        showClose: !1,
        widgetPositioning: {
            horizontal: "auto",
            vertical: "auto"
        },
        widgetParent: null,
        ignoreReadonly: !1,
        keepOpen: !1,
        focusOnShow: !0,
        inline: !1,
        keepInvalid: !1,
        datepickerInput: ".datepickerinput",
        keyBinds: {
            up: function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") ? this.date(t.clone().subtract(7, "d")) : this.date(t.clone().add(this.stepping(), "m"))
                }
            },
            down: function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") ? this.date(t.clone().add(7, "d")) : this.date(t.clone().subtract(this.stepping(), "m"))
                } else this.show()
            },
            "control up": function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") ? this.date(t.clone().subtract(1, "y")) : this.date(t.clone().add(1, "h"))
                }
            },
            "control down": function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") ? this.date(t.clone().add(1, "y")) : this.date(t.clone().subtract(1, "h"))
                }
            },
            left: function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") && this.date(t.clone().subtract(1, "d"))
                }
            },
            right: function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") && this.date(t.clone().add(1, "d"))
                }
            },
            pageUp: function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") && this.date(t.clone().subtract(1, "M"))
                }
            },
            pageDown: function (e) {
                if (e) {
                    var t = this.date() || this.getMoment();
                    e.find(".datepicker").is(":visible") && this.date(t.clone().add(1, "M"))
                }
            },
            enter: function () {
                this.hide()
            },
            escape: function () {
                this.hide()
            },
            "control space": function (e) {
                e && e.find(".timepicker").is(":visible") && e.find('.btn[data-action="togglePeriod"]').click()
            },
            t: function () {
                this.date(this.getMoment())
            },
            "delete": function () {
                this.clear()
            }
        },
        debug: !1,
        allowInputToggle: !1,
        disabledTimeIntervals: !1,
        disabledHours: !1,
        enabledHours: !1,
        viewDate: !1
    }, de.fn.datetimepicker
});
(function ($) {
    $(function () {
        $(".24h-form").datetimepicker({
            allowInputToggle: true,
            showClose: true,
            showClear: true,
            showTodayButton: true,
            format: "HH:mm:ss"
        });
        $("#id_4").datetimepicker({
            allowInputToggle: true,
            showClose: true,
            showClear: true,
            showTodayButton: true,
            format: "DD/MM/YYYY"
        })
    })
})(jQuery);
var _thisSubBtn;
var buttonSubmitTO;

function animateButton(e) {
    e.preventDefault;
    $(this).addClass("animate-spin");
    _thisSubBtn = this;
    let whichButton = $(this).attr("id");
    buttonSubmitTO = setTimeout(function () {
        errorSendButton(_thisSubBtn)
    }, 4e3);
    if (whichButton == "delaySubmit") {
        let delay = getValueDelay();
        if (delay != "failedRead") {
            delaySend(delay.action, delay.pins, delay.delay)
        }
    }
    if (whichButton == "planSubmit") {
        let plan = getValuePlan();
        if (plan != "failedRead") {
            if (plan.pow == "week") planWeekSend(plan.action, plan.pins, plan.week, plan.hours);
            else if (plan.pow == "date") planDataSend(plan.action, plan.pins, plan.data, plan.hours)
        }
    }
}
$(".submit-button").delegate(".button-sbm", "click", animateButton);

function successSendButton(classNm, msg=true) {
    if(msg) messageSee("Pomylnie wysano danie", "success");
    $(classNm).removeClass("animate-spin");
    $(classNm).addClass("animate-withoutSpin");
    $(classNm).addClass("success");
    setTimeout(function () {
        $(classNm).removeClass("animate-withoutSpin");
        $(classNm).removeClass("success")
    }, 2e3)
}

function errorSendButton(classNm, msg=true) {
    if(msg) messageSee("Nie udao si wysa dania", "failed");
    $(classNm).removeClass("animate-spin");
    $(classNm).addClass("animate-withoutSpin");
    $(classNm).addClass("error");
    setTimeout(function () {
        $(classNm).removeClass("animate-withoutSpin");
        $(classNm).removeClass("error")
    }, 2e3)
}

function nextDay(e) {
    return function (t) {
        var n = new Date(t || new Date);
        return new Date(n.getTime() + ((e - n.getDay() + 7) % 7 + 1) * 864e5)
    }
}(function (e) {
    function r(e, t) {
        var n = new Date(e),
            n = new Date(n.setDate(n.getDate() + Number(t))),
            r = n.getDate(),
            i = n.getMonth() + 1,
            s = n.getFullYear();
        return (r < 10 ? "0" + r : r) + "/" + (i < 10 ? "0" + i : i) + "/" + s
    }
    var t = "selectedDay";
    e.fn.weekLine = function (t) {
        if (n[t]) {
            return n[t].apply(this, Array.prototype.slice.call(arguments, 1))
        } else if (typeof t === "object" || !t) {
            return n.init.apply(this, arguments)
        } else {
            e.error("Method " + t + " does not exist on jQuery.weekLine")
        }
    };
    e.fn.weekLine.defaultSettings = {
        dayLabels: ["Pon", "Wt", "r", "Czw", "Pt", "Sob", "Niedz"],
        mousedownSel: true,
        startDate: null,
        onChange: null
    };
    var n = {
        init: function (n) {
            return this.each(function () {
                function u(n) {
                    e(n).toggleClass(t);
                    if (e.isFunction(r.settings.onChange)) {
                        r.settings.onChange.call(r)
                    }
                }
                var r = e(this),
                    s = false,
                    o = "";
                r.settings = e.extend(true, {}, e.fn.weekLine.defaultSettings, n || {});
                r.data("weekLine", r.settings);
                for (i in r.settings.dayLabels) {
                    o += '<a href="#">' + r.settings.dayLabels[i] + "</a>"
                }
                r.addClass("weekDays cleanslate").append(o).mouseup(function () {
                    s = false;
                    return false
                });
                $days = r.children().bind("mousedown", function () {
                    if (r.settings.mousedownSel) {
                        s = true
                    }
                    u(this);
                    return false
                }).bind("mouseenter", function () {
                    if (!s) {
                        return false
                    }
                    u(this);
                    return false
                })
            })
        },
        getSelected: function (n, i) {
            var s = e(this).data("weekLine"),
                o = null,
                u = "";
            this.children().each(function () {
                $day = e(this);
                if ($day.hasClass(t)) {
                    switch (n) {
                        case "indexes":
                            u += $day.attr("href").substr(1) + ",";
                            break;
                        case "dates":
                            u += r(i ? i : s.startDate ? s.startDate : new Date, $day.attr("href").substr(1)) + ",";
                            break;
                        case "descriptive":
                            if (o == null) {
                                u = $day.html()
                            } else {
                                if ($day.attr("href").substr(1) - o.attr("href").substr(1) == 1) {
                                    var a = u.split(",")[u.split(",").length - 1].split("-");
                                    if (a.length > 1) {
                                        u = u.replace(a[a.length - 1], $day.html())
                                    } else {
                                        u += "-" + $day.html()
                                    }
                                } else {
                                    u += ", " + $day.html()
                                }
                            }
                            o = $day;
                            break;
                        case "labels":
                        default:
                            u += $day.html() + ",";
                            break
                    }
                }
            });
            return u.replace(/,+$/, "")
        },
        setSelected: function (n) {
            var r = e(this),
                s = r.children(),
                o = n.split(",");
            s.removeClass(t);
            for (i in o) {
                s.filter(isNaN(o[i]) ? "a:contains('" + o[i] + "')" : "a:[href='#" + o[i] + "']").addClass(t)
            }
        }
    }
})(jQuery);
function genListElem() {
    var htmlListAction = "";
    // console.log(listActionElm)
    for (var el of listActionElm) {
        htmlListAction += ` <div class="pin_${allPins[el[3]][0]}_ac listElm" index="${listActionElm.indexOf(el)}">
                                        <div class="dt" data="${el[0][0] + "/" + el[0][1] + "/" + el[0][2]}"><p>${el[0][0] >= 0 && el[0][0] <= 9 ? "0" + el[0][0] : el[0][0]}.${el[0][1] >= 0 && el[0][1] <= 9 ? "0" + el[0][1] : el[0][1]}.${el[0][2]}</p></div>
                                        <div class="hr" hours="${el[1][0] + ":" + el[1][1]}"><p>${el[1][0] >= 0 && el[1][0] <= 9 ? "0" + el[1][0] : el[1][0]}:${el[1][1] >= 0 && el[1][1] <= 9 ? "0" + el[1][1] : el[1][1]}</p></div>
                                        <div class="ac" action="${el[2]}"><p>${el[2] ? "Wczenie" : "Wyczenie"}</p></div>
                                        <div class="nm" pin="${allPins[el[3]][0]}" indexPins="${el[3]}"><p>${allPins[el[3]][1]}(${allPins[el[3]][0]})</p></div>
                                    </div>`
    }
    $(".timetable .main .actionList .elemList").html(htmlListAction)
}

function genWeekListAction() {
    var htmlListAction = "";
    var indx = -1;
    for (var el of weekActionList) {
        indx++;
        let dayName = "";
        let dayNumber = "[";
        for(var nrDay of el[0]){
            dayNumber += `${nrDay}, `;
            switch(nrDay){
                case 0:
                    dayName += 'Poniedziaek, ';
                    break;
                case 1:
                    dayName += "Wtorek, ";
                    break;
                case 2:
                    dayName += "roda, ";
                    break;
                case 3:
                    dayName += "Czwartek, ";
                    break;
                case 4:
                    dayName += "Pitek, ";
                    break;
                case 5:
                    dayName += "Sobota, ";
                    break;
                case 6:
                    dayName += "Niedziela, ";
                    break;
            }
        }
        dayNumber = dayNumber.slice(0, -2) + "]";
        let pin = "";
        for(var ap of allPins){
            if(ap[0] == el[3])
                pin += `${ap[1]}(${ap[0]}), `;
        }
        htmlListAction += `<div class="listElm" index="${indx}" pin="${el[3]}">
            <div class="dt" dayNumber="${dayNumber}"><p>${dayName}</p></div>
            <div class="hr" date="${el[1][0]}:${el[1][1]}"><p>${el[1][0]}:${el[1][1]}</p></div>
            <div class="ac" action="${el[2]}"><p>${el[2] ? "Wczenie" : "Wyczenie"}</p></div>
            <div class="nm"><p>${pin}</p></div>
        </div>`
    }
    $(".timetable .main .weekList .elemList").html(htmlListAction)
}



if (getCookie("ESPSESSIONID")) {
    if (getCookie("ESPSESSIONID").length == 0) {
        location.reload()
    }
}

function getCookieToken() {
    return getCookie("ESPSESSIONID")
}
const gateway = `ws://${window.location.hostname}/ws`;
var websocket;
$(function () {
    onLoad()
});

function initWebSocket() {
    console.log("Trying to open a WebSocket connection...");
    websocket = new WebSocket(gateway);
    websocket.onopen = console.log("Poczenie z ESP zostao otwarte.");
    websocket.onclose = () => {
        console.log("Poczenie z ESP zostao zamknite ale nastpi prba ponownego otwarcia poczenia.");
        setTimeout(initWebSocket, 60000)
    };
    websocket.onmessage = onMessage
}

function onMessage(event) {
    let data = JSON.parse(event.data);
    // console.log(data)
    if (data.what == "power-now") {
        powerNow_change(data.action, data.pinID)
        let action = !data.action ? 0 : 1;
        let idPlace;
        for (let i = 0; i < allPins.length; i++)
            if (allPins[i][0] == parseInt(data.pinID)) {
                idPlace = i + 1;
                break;
            }
        for (let el of elementsPins)
            if (el[0] == idPlace) {
                el[1] = action;
                break;
            }

        $(".status .sts-list .pin_" + data.pinID + " span").toggleClass("off", !data.action);
        $(".status .sts-list .pin_" + data.pinID + " span").toggleClass("on", data.action);
        $(".status .sts-list .pin_" + data.pinID + " span").next().text(data.action ? "Wczone" : "Wyczone");
    } else if (data.what == "action-done" || data.what == "delay" || data.what == "planDate" || data.what == "planWeek" || data.what == "timetableRemove") {
        listActionElm = JSON.parse(data.arrayListActivity);
        if(data.arrayListActivity != null) genListElem()
    }else if(data.what == "temperatureRead"){
        updateTemperature(data.data);
    }else if(data.what == "setTemperature"){
        temperatureEle = JSON.parse(data.tempElem);
        generateTemp();
    }else if(data.what == "timetable"){
        listActionElm = JSON.parse(data.actionEle);
        genListElem();
    }else if(data.what == "weekactionremove"){
        weekActionList = JSON.parse(data.actionEle);
        genWeekListAction();
    }else if(data.what == "changePowerPin"){
        $(".power-now div.pin_" + data.pinID).toggleClass("off", !data.action);
        $(".power-now div.pin_" + data.pinID).toggleClass("on", data.action);
        $(".power-now div.pin_" + data.pinID + " input[type=checkbox]").prop("checked", data.action);

        $(".status .sts-list .pin_" + data.pinID + " span").toggleClass("off", !data.action);
        $(".status .sts-list .pin_" + data.pinID + " span").toggleClass("on", data.action);
        $(".status .sts-list .pin_" + data.pinID + " span").next().text(data.action ? "Wczone" : "Wyczone");
    }
}

function onLoad(event) {
    initWebSocket();
    initButton()
}

function initButton() {}

function fanClick() {}

function heatClick() {}

function getMobileToken(comm=true) {
    let JsonRet = $.ajax({
        url: "getMobileToken",
        method: "POST",
        data: {
            token: getCookieToken(),
            what: "getMobileToken"
        },
        async: false,
        success: function(){
            if(comm)
                messageSee("Pomylnie wykonano danie", "success")
        },
        error: function(){
            if(comm)
                messageSee("Bcz czenia z serwerem", "error")
        }
    });
    return JSON.parse(JsonRet.responseText);
}

function generateNewMobileToken() {
    let ret = $.ajax({
        url: "generateNewMobileToken",
        method: "POST",
        data: {
            token: getCookieToken(),
            what: "generateNewMobileToken"
        },
        async: false,
        success: function(){
            messageSee("Pomylnie wykonano danie", "success")
        },
        error: function(){
            messageSee("Bcz czenia z serwerem", "error")
        }
    });
    if(ret.responseText.length == 0) return "Generowanie tokenu nie piowiodo si.";
    return JSON.parse(ret.responseText);
}

function updateTemperature(date){
    for(let el of date){
        $(`.container .temperature .containerPins #pin_${el.pinID} .term-bar .deneme`).html(`${parseInt(el.curlTemp)}<span>${(el.curlTemp - parseInt(el.curlTemp)).toString().substr(1, 2)}</span><strong></strong>`);
    }
}

function powerNowSend(action, pinId) {
    let objJSON = {
        token: getCookieToken(),
        what: "power-now",
        action: action,
        pinID: pinId
    };
    $.ajax({
        url: "power",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function delaySend(action, pinId, delayDate) {
    let objJSON = {
        token: getCookieToken(),
        what: "delay",
        action: action,
        pinID: '"' + pinId + '"',
        delay: delayDate
    };
    $.ajax({
        url: "delay",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        errorSendButton(_thisSubBtn);
        clearTimeout(buttonSubmitTO)
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        successSendButton(_thisSubBtn);
        clearTimeout(buttonSubmitTO)
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function planDataSend(action, pinId, data, hours) {
    let objJSON = {
        token: getCookieToken(),
        what: "planDate",
        action: action,
        pinID: '"' + pinId + '"',
        date: data,
        hours: hours
    };
    $.ajax({
        url: "plan",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        errorSendButton(_thisSubBtn, false);
        clearTimeout(buttonSubmitTO, false);
        if(err.status == 302 && err.responseText == "FAILED - action exist") messageSee("Taka akcja ju istnieje", "failed")
        else messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        successSendButton(_thisSubBtn);
        clearTimeout(buttonSubmitTO)
         messageSee("Pomylnie wykonano danie", "success")
    })
}

function planWeekSend(action, pinId, dayWeek, hours) {
    let objJSON = {
        token: getCookieToken(),
        what: "planWeek",
        action: action,
        pinID: '"' + pinId + '"',
        dayWeek: '"' + dayWeek + '"',
        hours: hours
    };
    $.ajax({
        url: "plan",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        errorSendButton(_thisSubBtn, false);
        clearTimeout(buttonSubmitTO, false)
        if(err.status == 302 && err.responseText == "FAILED - action exist") messageSee("Taka akcja ju istnieje", "failed")
        else messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        successSendButton(_thisSubBtn);
        clearTimeout(buttonSubmitTO)
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function setTemperature(pinId, indexEle, temperature) {
    let objJSON = {
        token: getCookieToken(),
        what: "setTemperature",
        pinID: pinId,
        indexEle: indexEle,
        temperature: temperature
    };
    $.ajax({
        url: "setTemperature",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        temperatureEle = data.arrayTemperature;
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function timetableSend(indexElm, action, pinId, data, hours) {
    let objJSON = {
        token: getCookieToken(),
        what: "timetable",
        indexElm: indexElm,
        action: action,
        pinID: pinId,
        data: data,
        hours: hours
    };
    $.ajax({
        url: "timetableRemove",
        method: "DELETE",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function weekActionRemove(indexElm, action, pinId, dayNumber, hours) {
    let objJSON = {
        token: getCookieToken(),
        what: "weekactionremove",
        indexElm: indexElm,
        action: action,
        pinID: pinId,
        dayNumber: dayNumber,
        hours: hours
    };
    $.ajax({
        url: "weekActionRemove",
        method: "DELETE",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function changeUsernameSend(username, password){
    let objJSON = {
        token: getCookieToken(),
        what: "changeUsername",
        newUsername: username,
        password: password
    };
    $.ajax({
        url: "changeUsername",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function changePasswordSend(newPassword, oldPassword){
    let objJSON = {
        token: getCookieToken(),
        what: "changePassword",
        newPassword: newPassword,
        oldPassword: oldPassword
    };
    $.ajax({
        url: "changePassword",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function validitySessionSend(exp_day){
    let objJSON = {
        token: getCookieToken(),
        what: "validitySession",
        exp_day: exp_day
    };
    $.ajax({
        url: "validitySession",
        method: "POST",
        data: objJSON
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function mobileValiditySessionSend(exp_day){
    $.ajax({
        url: "mobileValiditySession",
        method: "POST",
        data: {
            token: getCookieToken(),
            what: "mobileValiditySession",
            exp_day: exp_day
        }
    }).fail(function (err) {
        messageSee("Nie udao si wysa dania", "failed")
    }).done(function (data) {
        messageSee("Pomylnie wykonano danie", "success")
    })
}

function powerNow_change(act, pinId) {
    if (act == "on" || act || act == "true") {
        $(".power-now .pin_" + pinId).removeClass("off").addClass("on");
        $(".power-now .pin_" + pinId + " .text-info .info-power").html("WCZONE")
    } else if (act == "off" || !act || act == "false") {
        $(".power-now .pin_" + pinId).removeClass("on").addClass("off");
        $(".power-now .pin_" + pinId + " .text-info .info-power").html("WYCZONE")
    }
}

function generatePins() {
    let delayPins = "";
    let pinName = "";
    for (let ele of allPins) {
        if (ele[2] == "power") {
            pinName = "";
            for (i = 0; i < ele[1].length; i++) {
                pinName += `<p>${ele[1][i]}</p>`
            }
            delayPins += `<div class="pin_${ele[0]}">
                                <div class="selector">
                                    <label class="checkbox bounce">
                                        <input type="checkbox" name="${ele[2]}" pin="${ele[0]}">
                                        <svg viewBox="0 0 21 21">
                                            <polyline points="5 10.75 8.5 14.25 16 6"></polyline>
                                        </svg>
                                    </label>
                                </div>
                                <div class="pin-name">${pinName}</div>
                            </div>`
        }
    }
    return delayPins
}
$(".pins-container").html(generatePins());

function getValueDelay() {
    let arrayPins = [];
    let actionTurn = false;
    let timeInp;
    $('.delay .pins-container > div div.selector .checkbox input[name="power"]').each(function () {
        if ($(this).is(":checked")) arrayPins.push(parseInt($(this).attr("pin")))
    });
    if (arrayPins.length == 0) {
        messageSee("Nie wybrano adnego pinu", "info");
        return "failedRead"
    }
    if ($(".delay .switchPower input.checkbox").is(":checked")) actionTurn = true;
    timeInp = $(".delay .timePicker input.form-control").val();
    if (timeInp.length == 0) {
        messageSee("Nie podano opnienia", "info");
        return "failedRead"
    }
    return {
        action: actionTurn,
        pins: arrayPins,
        delay: timeInp
    }
}
$(".plan .dataPicker .weekLine").weekLine();
$(function () {
    const Data = new Date;
    let dataFormat = Data.getDate() + "/" + (Data.getMonth() + 1) + "/" + Data.getFullYear();
    if (Data.getDate()  < 10) dataFormat = "0" + dataFormat;
    if (Data.getMonth() < 10) dataFormat = dataFormat.substring(0, 3) + "0" + dataFormat.substring(3, dataFormat.length);
    $("#id_4 input").val(dataFormat);
});
$(".plan-menu .date").click(function () {
    $(this).children().addClass("selected");
    $(this).next().children().removeClass("selected");
    $(".dataPicker .date").removeClass("hidden");
    $(".dataPicker .weekLine").addClass("hidden")
});
$(".plan-menu .weekDay").click(function () {
    $(this).children().addClass("selected");
    $(this).prev().children().removeClass("selected");
    $(".dataPicker .date").addClass("hidden");
    $(".dataPicker .weekLine").removeClass("hidden")
});

function getValuePlan() {
    let arrayPins = [];
    let turnPow = false;
    let date;
    let week = "";
    let hours;
    let pow;
    $('.plan .pins-container > div div.selector .checkbox input[name="power"]').each(function () {
        if ($(this).is(":checked")) arrayPins.push(parseInt($(this).attr("pin")))
    });
    if (arrayPins.length == 0) {
        messageSee("Nie wybrano adnego pinu", "info");
        return "failedRead"
    }
    if ($(".plan .switchPower").hasClass("on")) turnPow = true;
    if ($(".plan .plan-menu .date a").hasClass("selected")) pow = "date";
    if ($(".plan .plan-menu .weekDay a").hasClass("selected")) pow = "week";
    if (pow == "date") {
        date = $(".plan .dataPicker .date input.form-control").val();
        if (date.length == 0) {
            messageSee("Nie podano daty", "info");
            return "failedRead"
        }
    } else if (pow == "week"){
        let lm = 0;
        $(".plan .dataPicker .weekLine a").each(function(th){
            if($(this).hasClass("selectedDay")) week += week.length == 0 ? "" + lm : ", " + lm;
            lm++;
        })
    }
    hours = $('.plan .timePicker input[name="end_time"]').val();
    if (hours.length == 0) {
        messageSee("Nie podano godziny", "info");
        return "failedRead"
    }
    return {
        pow: pow,
        pins: arrayPins,
        action: turnPow,
        data: date,
        week: week,
        hours: hours
    }
}
var em = "";
var inf = {
    turn: "",
    pin: "",
    pinId: "",
    textTurn: "",
    namePin: "",
    check: "",
    classTurn: ""
};
for (var el of elementsPins) {
    inf.pin = allPins[el[0]][0];
    inf.pinId = el[0];
    inf.namePin = allPins[el[0]][1];
    if (el[1]) {
        inf.turn = "on";
        inf.textTurn = "WCZONE";
        inf.check = "checked";
        inf.classTurn = "power-on"
    } else {
        inf.turn = "off";
        inf.textTurn = "WYCZONE";
        inf.check = "";
        inf.classTurn = ""
    }
    em += `<div class="pin_${inf.pin} ${inf.turn}" id="pinId_${inf.pinId}">
    <span class="switch-ct">
        <label class="switch">
            <input type="checkbox" class="checkbox" name="pin_${inf.pin}" value="pin_${inf.pin}" ${inf.check} pin="${inf.pin}">
            <div class="slider">
                <svg viewBox="144.142 128.056 268.269 169.133" width="80%">
                    <path
                            d="M 162.624 242.721 C 159.204 242.721 156.567 241.824 154.714 240.031 C 152.854 238.244 151.924 235.381 151.924 231.441 C 151.924 227.501 152.854 224.634 154.714 222.841 C 156.567 221.048 159.204 220.151 162.624 220.151 C 166.037 220.151 168.674 221.048 170.534 222.841 C 172.387 224.634 173.314 227.501 173.314 231.441 C 173.314 235.381 172.387 238.244 170.534 240.031 C 168.674 241.824 166.037 242.721 162.624 242.721 Z M 162.624 237.741 C 163.257 237.741 163.734 237.571 164.054 237.231 C 164.367 236.898 164.524 236.378 164.524 235.671 L 164.524 227.211 C 164.524 226.504 164.367 225.981 164.054 225.641 C 163.734 225.308 163.257 225.141 162.624 225.141 C 161.991 225.141 161.514 225.308 161.194 225.641 C 160.874 225.981 160.714 226.504 160.714 227.211 L 160.714 235.671 C 160.714 236.398 160.874 236.924 161.194 237.251 C 161.514 237.578 161.991 237.741 162.624 237.741 ZM 188.179 242.331 L 175.269 242.331 L 175.269 237.741 L 176.669 237.741 L 176.669 225.141 L 175.269 225.141 L 175.269 220.551 L 192.009 220.551 L 192.009 227.801 L 187.059 227.801 L 187.059 225.141 L 184.509 225.141 L 184.509 229.791 L 188.739 229.791 L 188.739 232.981 L 184.509 232.981 L 184.509 237.741 L 188.179 237.741 L 188.179 242.331 ZM 206.875 242.331 L 193.965 242.331 L 193.965 237.741 L 195.365 237.741 L 195.365 225.141 L 193.965 225.141 L 193.965 220.551 L 210.705 220.551 L 210.705 227.801 L 205.755 227.801 L 205.755 225.141 L 203.205 225.141 L 203.205 229.791 L 207.435 229.791 L 207.435 232.981 L 203.205 232.981 L 203.205 237.741 L 206.875 237.741 L 206.875 242.331 Z"
                            transform="matrix(4.460696220397949, 0, 0, 4.4127678871154785, -530.53857421875, -813.1041870117188)"
                            fill="#fff" />
                </svg>
                <svg viewBox="98.062 117.952 264.418 196.833" width="80%">
                    <path
                            d="M 155.262 195.482 C 151.842 195.482 149.205 194.585 147.352 192.792 C 145.492 191.005 144.562 188.142 144.562 184.202 C 144.562 180.262 145.492 177.395 147.352 175.602 C 149.205 173.809 151.842 172.912 155.262 172.912 C 158.675 172.912 161.312 173.809 163.172 175.602 C 165.025 177.395 165.952 180.262 165.952 184.202 C 165.952 188.142 165.025 191.005 163.172 192.792 C 161.312 194.585 158.675 195.482 155.262 195.482 Z M 155.262 190.502 C 155.895 190.502 156.372 190.332 156.692 189.992 C 157.005 189.659 157.162 189.139 157.162 188.432 L 157.162 179.972 C 157.162 179.265 157.005 178.742 156.692 178.402 C 156.372 178.069 155.895 177.902 155.262 177.902 C 154.629 177.902 154.152 178.069 153.832 178.402 C 153.512 178.742 153.352 179.265 153.352 179.972 L 153.352 188.432 C 153.352 189.159 153.512 189.685 153.832 190.012 C 154.152 190.339 154.629 190.502 155.262 190.502 ZM 184.037 177.902 L 184.037 173.312 L 193.217 173.312 L 193.217 177.902 L 191.817 177.902 L 191.817 195.092 L 183.947 195.092 L 175.747 182.462 L 175.747 190.502 L 177.087 190.502 L 177.087 195.092 L 167.907 195.092 L 167.907 190.502 L 169.307 190.502 L 169.307 177.902 L 167.907 177.902 L 167.907 173.312 L 178.017 173.312 L 185.377 184.532 L 185.377 177.902 L 184.037 177.902 Z"
                            transform="matrix(5.298288822174072, 0, 0, 5.131278991699219, -664.4776611328125, -734.0007934570312)"
                            fill="#fff" />
                </svg>
            </div>
        </label>
    </span>
    <span class="text-info">
        <p class="info-power ${inf.classTurn}">${inf.textTurn}</p>
        &nbsp;
        <p class="info-pin" title="${inf.namePin.toUpperCase()}">${inf.namePin.toUpperCase().length > 7 ? inf.namePin.toUpperCase().substring(0, 5) + "..." : inf.namePin.toUpperCase()}</p>
    </span>
</div>`
}
$(".power-now").html(em);
$(".power-now .switch").click(function (event) {
    if ($(event.target).is("input")) {
        powerNowSend($(event.target).is(":checked"), $(this).children("input").attr("pin"))
    }
});
$(".switch-static").click(function (event) {
    if ($(event.target).is("input")) {
        if ($(event.target).is(":checked")) {
            $(event.target).closest(".switch-ct").parent().removeClass("off").addClass("on");
        } else {
            $(event.target).closest(".switch-ct").parent().removeClass("on").addClass("off");
        }
    }
});
var themeMode = "dark";
if (getCookie("theme")) {
    $("body").attr("data-mode", getCookie("theme"));
    themeMode = getCookie("theme")
}
$(function () {
    $("body").delegate(".setting-window .setting-window-top-menu li", "click", function () {
        $(".setting-window .setting-window-top-menu li").removeClass("select");
        $(this).addClass("select");
        $(".setting-window .content div").removeClass("d-flex");
        $("." + $(this).attr("id")).addClass("d-flex")
    });
    $(".topBar .settings-btn").click(function () {
        $("body").prepend(`<div class="setting-window">
            <div div class= "close-window" > <i class="fas fa-times"></i></div >
        <ul class="setting-window-top-menu">
            <li class="select" id="user-sett">Uytkownik</li>
            <li id="access-sett">Zabezpieczenia</li>
            <li id="restart">Zarzdzaj</li>
        </ul>
        <div class="content">
            <div></div>
            <div class="user-sett d-flex">
                <div class="free"></div>
                <div class="user-name">
                    <h2>Nazwa uytkownika</h2>
                    <input type="text" name="newUsername" placeholder="Nowa nazwa uytkownika">
                    <input type="password" name="password" placeholder="Haso">
                    <div class="submit-button col-4">
                        <button class="button-sbm" id="delaySubmit">Zatwierd</button>
                    </div>
                </div>
                <div class="free"></div>
                <div class="password-user">
                    <h2>Haso</h2>
                    <input type="password" name="oldPassword" placeholder="Podaj aktualne haso">
                    <input type="password" name="newPassword" placeholder="Podaj nowe haso">
                    <input type="password" name="repeat-newPassword" placeholder="Powtrz nowe haso">
                    <div class="submit-button col-4">
                        <button class="button-sbm" id="delaySubmit">Zatwierd</button>
                    </div>
                </div>
                <div class="page-theme">
                    <div class="mode-page col-4 h-50">
                        <div class="wrappery">
                            <input type="checkbox" name="checkbox" class="switch-theme" mode="${themeMode}">
                        </div>
                    </div>
                </div>
            </div>
            <div class="access-sett">
                <div class="free"></div>
                <div class="exp-date">
                    <p>Wano sesji</p>
                    <p>Ilo dni:</p>
                    <input type="number" value="30" name="exp-day" placeholder="Ilo dni">
                    <!-- <p>Ilo minut:</p>
                       <input type="number" id="" placeholder="Godzin:Minut lub Minut"> -->
                    <div class="submit-button col-4">
                        <button class="button-sbm" id="delaySubmit">Zatwierd</button>
                    </div>
                </div>
                <div class="free"></div>
                <div class="mobile-token ">
                    <p>Token dostpu z aplikacji mobilnej</p>
                    <div id="mobileToken">
                        <p contenteditable id="token">${getMobileToken().result}</p>
                        <i class="fas fa-copy copyToClipboard"></i>
                        <i class="fas fa-redo generateNew"></i>
                    </div>
                    <div class="day-number">
                        <p>Ilo dni: </p>
                        <input type="number" placeholder="Ilosc dni wanoci" value="365" name="mobile_exp_day">
                    </div>
                    <div class="submit-button col-4">
                        <button class="button-sbm" id="delaySubmit">Zatwierd</button>
                    </div>
                </div>
            </div>
            <div class="restart">
                <div class="cnt">
                    <div class="restart-power">
                        <button class="button-sbm" id="restart-btn">Uruchom ponownie urzdzenie</button>
                    </div>
                    <input type="password" name="password" id="rest-pass" placeholder="Haso">
                    <div class="resetuj-divice">
                        <input type="checkbox" name="check" id="check">
                        <button class="button-sbm" id="reset-btn" disabled>Resetuj urzdzenie do ustawie fabrycznych</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="blure">&nbsp;</div>`)
    });
    $("body").delegate(".setting-window .close-window", "click", function () {
        $(".setting-window").remove();
        $(".blure").remove()
    });
    $("body").delegate(".setting-window .content .user-name .button-sbm", "click", function () {
        let username = $('.setting-window .content .user-name input[name="newUsername"]').val();
        let password = $('.setting-window .content .user-name input[name="password"]').val();
        changeUsernameSend(username, password);
    });
    $("body").delegate(".setting-window .content .password-user .button-sbm", "click", function () {
        let oldPassword = $('.setting-window .content .password-user input[name="oldPassword"]').val();
        let newPassword = $('.setting-window .content .password-user input[name="newPassword"]').val();
        let newPasswordRepeat = $('.setting-window .content .password-user input[name="repeat-newPassword"]').val();
        if(newPassword == newPasswordRepeat) changePasswordSend(newPassword, oldPassword);
        else alert("Hasa si nie zgadzaj. Wprowad te same hasa.");
    });
    $("body").delegate(".setting-window .content .access-sett .exp-date .button-sbm", "click", function () {
        let exp_day = $('.setting-window .content .access-sett .exp-date input[name="exp-day"]').val();
        validitySessionSend(exp_day);
    });
    $("body").delegate(".setting-window .content .access-sett .mobile-token .button-sbm", "click", function () {
        let exp_day = $('.setting-window .content .access-sett .mobile-token input[name="mobile_exp_day"]').val();
        mobileValiditySessionSend(exp_day);
    });
    $("body").delegate(".setting-window .content .page-theme .wrappery .switch-theme", "click", function () {
        if ($(this).attr("mode") == "dark") {
            setCookie("theme", "light");
            $("body").attr("data-mode", "light");
            $(this).attr("mode", "light");
            themeMode = "light"
        } else if ($(this).attr("mode") == "light") {
            setCookie("theme", "dark");
            $("body").attr("data-mode", "dark");
            $(this).attr("mode", "dark");
            themeMode = "dark"
        }
    });
    $("body").delegate(".setting-window .mobile-token .copyToClipboard", "click", function (event) {
        document.querySelector("#token").focus();
        document.execCommand("selectAll", false, null);
        try {
            var successful = document.execCommand("copy");
            if (successful) messageSee("Pomylnie skopiowano", "success");
            else messageSee("Kopiowanie nie powiodo si. Sprbuj jeszcze raz.", "failed")
        } catch (err) {
            messageSee("Co poszo nie tak z kopiowaniem. Sprbuj jeszcze raz.", "failed")
        }
    });
    $("body").delegate(".setting-window .mobile-token p", "keydown", function (event) {
        event.preventDefault()
    });
    $("body").delegate(".setting-window #mobileToken .generateNew", "click", function () {
        let newToken = generateNewMobileToken().result || false;
        if (!newToken) {
            messageSee("Wygenerowanie nie powiodo si. Sprbuj jeszcze raz.", "failed")
        }else {
            messageSee("Pomylnie wygenerowano", "success");
            $(".setting-window .mobile-token #mobileToken #token").text(newToken)
        }
    })
});
$(function () {
    let htmlStatusList = "";
    let posi;
    for (let em of allPins) {
        if (em[2] == "power" || em[2] == "air" || em[2] == "heat") {
            posi = -1;
            if (em[2] == "power")
                for (let lm of elementsPins) {
                    if (lm[0] == allPins.indexOf(em)) posi = lm[1]
                } else if (em[2] == "air")
                    for (let lm of tmpEm) {
                        if (lm[1] == allPins.indexOf(em)) {
                            for (let elm of temperatureEle) {
                                if (lm[0] == elm[0]) {
                                    posi = elm[2];
                                    break
                                }
                            }
                            break
                        }
                    } else if (em[2] == "heat")
                        for (let lm of tmpEm) {
                            if (lm[2] == allPins.indexOf(em)) {
                                for (let elm of temperatureEle) {
                                    if (lm[0] == elm[0]) {
                                        posi = elm[3];
                                        break
                                    }
                                }
                                break
                            }
                        }
            htmlStatusList += `<div class="pin_${em[0]}"><div><span class="${posi ? "on" : "off"}"></span>
                                                    <p>${posi ? "Wczone" : "Wyczone"}</p>
                                                </div>
                                                <div>
                                                    <p>${em[1]}</p>
                                                </div>
                                            </div>`
        }
    }
    $("main .status .sts-list").html(htmlStatusList)
});
function generateTemp(){
    var htmlMenu = "";
    var htmlElem = "";
    let airOn = "";
    let heatOn = "";
    let firstElem = true;
    let tempeF = "";
    let tempeS = "";
    let whatName = 100 / temperatureEle.length < 15 ? true : false;
    for (var elm of temperatureEle) {
        htmlMenu += `<div class="pinsMenu ${!temperatureEle.indexOf(elm) ? "select" : ""}" id="pin_${allPins[tmpEm[elm[0]][0]][0]}" style="width: ${100 / temperatureEle.length}%; ${!temperatureEle.indexOf(elm) ? "border-top-left-radius: 20px;" : ""}${temperatureEle.indexOf(elm) == temperatureEle.length - 1 ? "border-top-right-radius: 20px;" : ""} ">${whatName ?allPins[tmpEm[elm[0]][0]][0] : allPins[tmpEm[elm[0]][0]][1]}</div>`;
        if (elm[3]) airOn = "pw-on";
        if (elm[4]) heatOn = "pw-on";
        tempeF = elm[4].substring(0, elm[4].indexOf("."));
        tempeS = elm[4].substring(elm[4].indexOf(".") + 1, elm[4].lenght);
        htmlElem += ` <div id="pin_${allPins[tmpEm[elm[0]][0]][0]}" style="display: ${!temperatureEle.indexOf(elm) ? "flex" : "none"}">
                    <h3>${allPins[tmpEm[elm[0]][0]][1]}</h3>
                    <div class="term-bar">
                        <div class="den">
                            <div class="dene">
                                <div class="denem">
                                    <div class="deneme">
                                        ${tempeF}<span>.${tempeS}</span><strong>&deg;</strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="icon-sts">
                        <div class="fan ${airOn}" id="pin_${allPins[tmpEm[elm[0]][0]][0]}">
                            <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 164.97 164.97"
                                style="enable-background:new 0 0 164.97 164.97;" xml:space="preserve">
                                <path d="M153.679,103.607c-7.948-6.581-16.133-7.965-23.354-9.186c-4.795-0.811-8.715-1.483-12.168-3.469 c19.313-4.195,33.809-14.162,41.238-28.565c7.123-13.809,6.648-30.314-1.299-45.279c-4.818-9.086-15.28-15.717-26.651-16.893 c-10.926-1.129-21.093,2.913-27.905,11.106c-6.58,7.948-7.964,16.133-9.185,23.354c-0.805,4.761-1.474,8.658-3.426,12.093 c-4.191-19.323-14.16-33.826-28.567-41.259C48.553-1.614,32.048-1.141,17.08,6.806C7.993,11.626,1.362,22.088,0.186,33.461 C-0.943,44.386,3.1,54.552,11.292,61.363c7.949,6.581,16.134,7.965,23.355,9.186c4.796,0.811,8.716,1.483,12.17,3.47 c-19.314,4.194-33.81,14.161-41.24,28.564c-7.123,13.809-6.649,30.314,1.298,45.28c4.819,9.087,15.282,15.718,26.655,16.893 c1.206,0.125,2.401,0.187,3.585,0.187c9.542,0,18.257-4.005,24.316-11.292c6.581-7.948,7.965-16.133,9.186-23.354 c0.805-4.761,1.474-8.659,3.426-12.094c4.191,19.323,14.16,33.826,28.567,41.258c6.499,3.353,13.594,5.022,20.846,5.022 c8.157,0,16.512-2.113,24.435-6.32c9.087-4.819,15.717-15.282,16.893-26.655C165.913,120.584,161.87,110.418,153.679,103.607z  M82.485,101.144c-10.289,0-18.66-8.371-18.66-18.659s8.371-18.659,18.66-18.659s18.66,8.371,18.66,18.659 S92.774,101.144,82.485,101.144z M109.144,37.175c1.038-6.138,1.934-11.439,5.938-16.276c4.861-5.845,11.371-6.121,14.818-5.764 c6.335,0.655,12.48,4.356,14.945,9.005c5.692,10.717,6.125,21.858,1.218,31.371c-5.252,10.183-15.963,17.376-30.521,20.663 c-1.572-8.248-6.161-15.437-12.575-20.372C107.048,49.493,108.184,42.849,109.144,37.175z M20.87,49.82 c-5.845-4.86-6.12-11.369-5.763-14.816c0.655-6.337,4.356-12.482,9.005-14.947c10.719-5.691,21.861-6.123,31.372-1.217 c10.199,5.261,17.4,15.997,20.679,30.59c-8.23,1.571-15.403,6.147-20.335,12.54c-6.324-4.108-12.99-5.249-18.68-6.211 C31.009,54.721,25.707,53.825,20.87,49.82z M55.827,127.795c-1.038,6.138-1.935,11.439-5.94,16.277 c-4.86,5.845-11.373,6.12-14.815,5.763c-6.336-0.655-12.482-4.356-14.947-9.004c-5.692-10.718-6.124-21.859-1.217-31.372 c5.252-10.182,15.962-17.376,30.52-20.661c1.572,8.248,6.162,15.436,12.576,20.371C57.923,115.477,56.786,122.122,55.827,127.795z  M149.864,129.966c-0.655,6.337-4.356,12.482-9.004,14.947c-10.719,5.692-21.859,6.124-31.373,1.217 c-10.199-5.261-17.4-15.997-20.678-30.591c8.23-1.571,15.403-6.146,20.335-12.541c6.324,4.109,12.99,5.25,18.679,6.212 c6.138,1.038,11.439,1.934,16.277,5.939C149.945,120.01,150.22,126.519,149.864,129.966z" />    
                            </svg>
                        </div>
                        <div class="heat ${heatOn}" id="pin_${allPins[tmpEm[elm[0]][0]][0]}">
                            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 511.998 511.998" style="enable-background:new 0 0 511.998 511.998;" xml:space="preserve">
                                <path d="M501.34,117.336c-5.906,0-10.688,4.773-10.688,10.664v85.335H469.34v-21.336c0-23.523-19.156-42.663-42.688-42.663c-12.718,0-24.155,5.609-31.999,14.491c-7.812-8.882-19.25-14.491-32-14.491c-12.718,0-24.155,5.609-31.999,14.491c-7.812-8.882-19.25-14.491-32-14.491c-12.719,0-24.156,5.609-31.992,14.491c-7.82-8.882-19.258-14.491-32-14.491c-12.726,0-24.171,5.609-32,14.491c-7.82-8.882-19.258-14.491-32-14.491c-12.726,0-24.171,5.609-32,14.491c-7.82-8.882-19.258-14.491-32-14.491c-19.835,0-36.57,13.616-41.32,31.999H32c-5.891,0-10.664,4.773-10.664,10.664v21.336H10.664C4.773,213.335,0,218.108,0,223.999s4.773,10.664,10.664,10.664h10.672v21.336c0,5.891,4.773,10.664,10.664,10.664h32v202.678c0,23.516,19.141,42.656,42.664,42.656c12.742,0,24.18-5.625,32-14.5c7.828,8.875,19.273,14.5,32,14.5c12.742,0,24.18-5.625,32-14.5c7.828,8.875,19.273,14.5,32,14.5c12.742,0,24.18-5.625,32-14.5c7.836,8.875,19.273,14.5,31.992,14.5c12.75,0,24.188-5.625,32-14.5c7.844,8.875,19.281,14.5,31.999,14.5c12.75,0,24.188-5.625,32-14.5c7.844,8.875,19.281,14.5,31.999,14.5c23.531,0,42.688-19.141,42.688-42.656V234.663h32c5.875,0,10.656-4.773,10.656-10.664V128C511.996,122.109,507.215,117.336,501.34,117.336z M64,245.335H42.664v-42.672H64V245.335z M127.999,469.341c0,11.75-9.563,21.312-21.336,21.312c-11.757,0-21.328-9.562-21.328-21.312V255.999v-64c0-11.758,9.57-21.336,21.328-21.336c11.773,0,21.336,9.578,21.336,21.336V469.341z M191.999,469.341c-0.001,11.75-9.563,21.312-21.336,21.312c-11.757,0-21.328-9.562-21.328-21.312V191.999c0-11.758,9.57-21.336,21.328-21.336c11.773,0,21.336,9.578,21.336,21.336V469.341z M255.998,469.341c0,11.75-9.562,21.312-21.336,21.312c-11.757,0-21.328-9.562-21.328-21.312V191.999c0-11.758,9.57-21.336,21.328-21.336c11.773,0,21.336,9.578,21.336,21.336V469.341zM319.998,469.341c0,11.75-9.562,21.312-21.344,21.312c-11.75,0-21.312-9.562-21.312-21.312V191.999c0-11.758,9.562-21.336,21.312-21.336c11.781,0,21.344,9.578,21.344,21.336V469.341z M383.997,469.341c0,11.75-9.562,21.312-21.344,21.312c-11.749,0-21.312-9.562-21.312-21.312V191.999c0-11.758,9.562-21.336,21.312-21.336c11.781,0,21.344,9.578,21.344,21.336V469.341z M447.996,469.341c0,11.75-9.562,21.312-21.344,21.312c-11.749,0-21.312-9.562-21.312-21.312V191.999c0-11.758,9.562-21.336,21.312-21.336c11.781,0,21.344,9.578,21.344,21.336V469.341z" />
                                <path d="M356.871,103.672c-1.312-4.539-0.5-7.844,2.688-11.055c8.656-8.695,11.531-19.984,8.062-31.812c-2.312-7.938-6.812-13.547-7.375-14.25c-0.031,0-0.031-0.008-0.031-0.008v-0.015c-1.969-2.359-4.906-3.867-8.219-3.867c-5.89,0-10.655,4.781-10.655,10.672c0,2.586,0.906,4.961,2.438,6.805c0.031,0.023,2.281,2.938,3.375,6.656c1.266,4.367,0.469,7.586-2.719,10.766c-8.625,8.678-11.515,20.045-8.078,31.998c2.328,8.102,6.828,13.836,7.328,14.469v-0.008c1.969,2.422,4.953,3.977,8.312,3.977c5.891,0,10.656-4.773,10.656-10.664c0-2.539-0.875-4.867-2.344-6.695C360.278,110.61,357.965,107.555,356.871,103.672z" />
                                <path d="M268.656,96.61c-2.461-9.836-0.492-18.195,6-25.547c11.406-12.891,15.031-28.695,10.5-45.726c-3.188-11.938-9.312-20.227-10-21.133V4.22c-1.969-2.555-5.023-4.219-8.492-4.219c-5.893,0-10.666,4.773-10.666,10.664c0,2.414,0.805,4.633,2.156,6.414h-0.016c0.047,0.062,4.492,6.109,6.547,14.32c2.453,9.827,0.484,18.187-6.016,25.538c-11.39,12.891-15.015,28.696-10.483,45.727c3.172,11.938,9.305,20.227,9.984,21.133l0.016-0.016c1.945,2.57,5.016,4.219,8.477,4.219c5.898,0,10.68-4.773,10.68-10.664c0-2.414-0.812-4.633-2.156-6.414C275.14,110.86,270.695,104.813,268.656,96.61z" />
                                <path d="M189.64,110.641c-0.023-0.031-2.328-3.086-3.445-6.969c-1.305-4.539-0.5-7.844,2.695-11.055c8.664-8.695,11.523-19.984,8.062-31.812c-2.32-7.938-6.789-13.531-7.391-14.25c0,0,0-0.008-0.008-0.008l-0.008-0.023v0.008c-1.961-2.359-4.906-3.867-8.211-3.867c-5.891,0-10.672,4.781-10.672,10.672c0,2.586,0.922,4.961,2.453,6.805c0.023,0.023,2.273,2.938,3.359,6.656c1.281,4.367,0.469,7.586-2.703,10.766c-8.64,8.678-11.515,20.045-8.077,31.998c2.328,8.102,6.828,13.836,7.336,14.469v-0.008c1.961,2.422,4.945,3.977,8.305,3.977c5.891,0,10.664-4.773,10.664-10.664c0-2.539-0.891-4.867-2.367-6.695H189.64z" />
                            </svg>
                        </div>
                    </div>
                    <div class="setTemperature" pin="${allPins[tmpEm[elm[0]][0]][0]}" indexele="${temperatureEle.indexOf(elm)}">
                        <span>Utrzymywana temperatura</span>
                        <span>${elm[1]}</span>
                        <span>&#x2103;</span>
                    </div>
                </div>`;
        if (firstElem) firstElem = false
        $(".temperature .selectPins").html(htmlMenu);
        $(".temperature .containerPins").html(htmlElem);
    }
}
$(function () {
    generateTemp();
    $(".pinsMenu").click(function () {
        $(".temperature .selectPins div").removeClass("select");
        $(this).addClass("select");
        $(".containerPins > div").css("display", "none");
        $(".containerPins #" + $(this).attr("id")).css("display", "flex")
    });
    $(".temperature .containerPins .fan svg").click(fanClick);
    $(".temperature .containerPins .heat svg").click(heatClick);
    $(".temperature").delegate(".setTemperature", "mouseenter", function () {
        $(this).append(`<div class="setTemperature-tooltip tooltip-edit" tooltip-edit pin="${$(this).attr("pin")}"> <i class="fas fa-pen"></i></div>`)
    })
    $(".temperature").delegate(".setTemperature", "mouseleave", function (event) {
        $(this).children(".setTemperature-tooltip").remove()
    });
    $("body").delegate(".setTemperature-window .close-wind", "click", function () {
        $(".setTemperature-window").remove();
        $(".blure").remove()
    });
    $("body").delegate("#inpTemperatureSet", "keydown", function (event) {
        if (!(event.which >= 48) || !(event.which <= 57) && event.which != 189 && event.which != 190) event.preventDefault()
    });
    $(".temperature").delegate(".setTemperature .setTemperature-tooltip", "click", function (e) {
        $("body").prepend(`<div class="blure">&nbsp;</div>`);
        $("body").prepend(`<div class="setTemperature-window">
        <div class="closes-window"><i class="close-wind fas fa-times"></i></div>
        <form>
            <input id="inpTemperatureSet" type="text" name="temperature" placeholder="Podaj temperature"
                autocomplete="off" pin="${$(this).attr("pin")}" index="${$(this).attr("index")}">
        </form>
        <div class="submit-button">
            <button id="setTemperature-submit" class="button-sbm delaySubmit">Zatwierd</button>
        </div>
        <div class="info">
            <div>
                <i class="fas fa-info-circle"></i>
                <span>Znak mylnika(-) - umoliwia podanie zakresu temperatur np: 20.2-24</span>
            </div>
        </div>
    </div>`)
    });
    $("body").delegate("#setTemperature-submit", "click", function () {
        setTemperature($("#inpTemperatureSet").attr("pin"), $("#inpTemperatureSet").attr("indexele"), $("#inpTemperatureSet").val())
    })
    genListElem();
    genWeekListAction();
    $(".timetable .actionList .elemList").delegate(".list-elem-tooltip", "click", function () {
        let indxElm = $(this).parent().attr("index");
        timetableSend(indxElm, $(this).prev().prev().attr("action"), $(this).prev().attr("pin"), $(this).prev().prev().prev().prev().attr("data"), $(this).prev().prev().prev().attr("hours"))
    });
    $(".timetable .weekList .elemList").delegate(".list-elem-tooltip", "click", function () {
        let indxElm = $(this).parent().attr("index");
        let pinElm = $(this).parent().attr("pin");
        let dayNbElm = $(this).parent().children('.dt').attr("dayNumber");
        let dateElm = $(this).parent().children('.hr').attr("date");
        let actionElm = $(this).parent().children('.ac').attr("action");
        console.log("Index: " + indxElm + "    Pin: " + pinElm + "    DayNb: " + dayNbElm + "    Date: " + dateElm + "    Action: " + actionElm)
        weekActionRemove(indxElm, actionElm, pinElm, dayNbElm, dateElm)
    });
    $(".timetable .cld-menu > div").click(function () {
        $(".timetable .cld-menu > div").removeClass("select");
        $(this).addClass("select");
        $(".timetable .main > div").removeClass("select");
        $(".timetable .main ." + $(this).attr("em")).addClass("select")
    });
    $(".timetable .elemList").delegate(".listElm", "mouseenter", function (event) {
        $(this).append('<div class="list-elem-tooltip" tooltip><i class="fas fa-trash"></i></div>')
    });
    $(".timetable .elemList").delegate(".listElm", "mouseleave", function () {
        $(".timetable .elemList .listElm .list-elem-tooltip").remove()
    })
});

function messageSee(text, action) {
    if (!($('div.messageAlert').length)) {
        $('body').prepend(`<div class="messageAlert ${action}"><p>${text}</p></div>`);
        $('.messageAlert').css({
            'right': '-300%'
        }).animate({
            "right": "10"
        }, "slow")
        setTimeout(function () {
            $('.messageAlert').css({
                'right': '10px'
            }).animate({
                "right": "-300%"
            }, "slow")
            setTimeout(function () {
                $('.messageAlert').remove();
            }, 500)
        }, 2000)
    }
}

$('#logout-page').click(function(event){
    event.preventDefault();
    location.href="?logout";
})

// var updateData = {};

// $(document).ready(function(){
//     $("bar").delegate('#close-update', 'click', function(){
//         $("#update-info").removeClass("show").addClass("hide");
//         setTimeout(function(){
//             $("#update-info").remove();
//             $("#bg-oppacity").remove();
//         }, 1000);
//     });

//     $("bar").delegate('#show-update-detail', 'click', function(){
//         $.ajax({
//             url: dataUpdate.description_url,
//             method: "GET",
//             success: function(data){
//                 updateData.description = data;
//             }
//         });

//         $('#update-bar').remove();
//         $('body').prepend(`<div id="bg-oppacity"></div>
//             <popup id="update-info" class="show">
//                 <button id="close-update" type="button"><i class="fas fa-times"></i></button>
//                 <h1>Nowa Aktualizacja</h1>
//                 <h3>
//                     Zostaa wypuszczona nowa aktualizacja oprogramowania
//                 </h3>
//                 <ul id="data-update">
//                     <li>Wersja: <span>${dataUpdate.version}</span></li>
//                     <li>Opis: <span>${dataUpdate.description}</span></li>
//                 </ul>
//                 <a href="/update"><button id="update-info-update">Aktualizuj</button></a>
//             </popup>`)
//     });

//     $.ajax({
//         url: '/updatesoftware/check',
//         method: 'POST',
//         data: {
//             token: getCookieToken(),
//             what: "checkUpdate"
//         },
//         success: function(data){
//             let dataUpdate = JSON.parse(data);
//             console.log(data);
//             console.log(dataUpdate);
//             if(dataUpdate.status == 'success'){
//                 if(dataUpdate.update){
//                     updateData = {"version": dataUpdate.version, "description_url": dataUpdate.description_url};
//                     console.log(updateData);
//                     $('body').prepend(`<popup id="update-bar">
//                             <button id="close-popup-bar" type="button" title="Zamknij Komunikat"><i class="fas fa-times"></i></button>
//                             <span>Nowa aktualizacja</span>
//                             <button type="button" id="show-update-detail" title="Poka szczegy aktualizacji">Zobacz Szczegy</button>
//                         </popup>`);
//                 }
//             }
//         }
//     });
// });

$('body').delegate('#restart-btn', 'click', function(event){
    event.preventDefault();
    if($('#rest-pass').val().length == 0) return alert("Nie podano hasa");
    if(!confirm("Czy na pewno chcesz uruchomi ponownie urzdzenie?")) return;
    $.ajax({
        url: '/restart',
        method: 'POST',
        data: {
            token: getCookieToken(),
            password: $('#restart-pass').val(),
            what: "restart"
        },
        success: function(data){
            console.log(data);
            messageSee("Restart urzdzenia w toku...", "success");
        }
    });
});

$("body").delegate('#check', 'click', function(event){
    if(this.checked) $('#reset-btn').removeAttr('disabled');
    else $('#reset-btn').attr('disabled', 'disabled');
});
$('body').delegate('#reset-btn', 'click', function(event){
    event.preventDefault();
    if($('#rest-pass').val().length == 0) return alert("Nie podano hasa");
    if(!confirm("Czy na pewno chcesz przywruci urzdzenie do ustawie fabrycznych?")) return;
    $.ajax({
        url: '/factoryreset',
        method: 'POST',
        data: {
            token: getCookieToken(),
            password: $('#restart-pass').val(),
            what: "factoryreset"
        },
        success: function(data){
            console.log(data);
            messageSee("Przywracanie do ustawie fabrycznych urzdzenia w toku...", "success");
        }
    });
});